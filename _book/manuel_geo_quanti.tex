% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{book}
\usepackage{amsmath,amssymb}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math} % this also loads fontspec
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
\usepackage{lmodern}
\ifPDFTeX\else
  % xetex/luatex font selection
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{longtable,booktabs,array}
\usepackage{calc} % for calculating minipage widths
% Correct order of tables after \paragraph or \subparagraph
\usepackage{etoolbox}
\makeatletter
\patchcmd\longtable{\par}{\if@noskipsec\mbox{}\fi\par}{}{}
\makeatother
% Allow footnotes in longtable head/foot
\IfFileExists{footnotehyper.sty}{\usepackage{footnotehyper}}{\usepackage{footnote}}
\makesavenoteenv{longtable}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{5}
\usepackage{booktabs}
\usepackage{amsthm}
\makeatletter
\def\thm@space@setup{%
  \thm@preskip=8pt plus 2pt minus 4pt
  \thm@postskip=\thm@preskip
}
\makeatother
\usepackage{array}
\usepackage{caption}
\usepackage{graphicx}
\usepackage{siunitx}
\usepackage[normalem]{ulem}
\usepackage{colortbl}
\usepackage{multirow}
\usepackage{hhline}
\usepackage{calc}
\usepackage{tabularx}
\usepackage{threeparttable}
\usepackage{wrapfig}
\usepackage{adjustbox}
\usepackage{hyperref}
\usepackage{booktabs}
\usepackage{longtable}
\usepackage{float}
\usepackage{pdflscape}
\usepackage{tabu}
\usepackage{threeparttablex}
\usepackage{makecell}
\usepackage{xcolor}
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\usepackage[]{natbib}
\bibliographystyle{apalike}
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same}
\hypersetup{
  pdftitle={Méthodes Quantitatives en Géographie},
  pdfauthor={Hugo Périlleux},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}

\title{Méthodes Quantitatives en Géographie}
\author{Hugo Périlleux}
\date{2024-10-18}

\begin{document}
\maketitle

{
\setcounter{tocdepth}{1}
\tableofcontents
}
\hypertarget{introduction}{%
\chapter*{Introduction}\label{introduction}}
\addcontentsline{toc}{chapter}{Introduction}

Ce manuel est le matériel des travaux pratiques 2024-2025 pour le cours GEOG-F-404 Méthodes Quantitatives en Géographie à l'Université Libre de Bruxelles.

Il contient 3 chapitres:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  \href{https://bookdown.org/hugoperilleux/manuel_geo_quanti/r\%C3\%A9gressions.html}{Régression}
\item
  \href{https://bookdown.org/hugoperilleux/manuel_geo_quanti/analyse-en-composantes-principales.html}{Analyse en composantes principales}
\item
  \href{https://bookdown.org/hugoperilleux/manuel_geo_quanti/classification.html}{Classification}
\end{enumerate}

\hypertarget{ruxe9gressions}{%
\chapter{Régressions}\label{ruxe9gressions}}

données utilisées:

\begin{itemize}
\item
  immoweb\_louer.csv
\item
  census\_2011\_logements.xls
\item
  cantons\_judiciaires\_bxl\_2018.gpkg
\end{itemize}

\hypertarget{pruxe9paration}{%
\section{Préparation}\label{pruxe9paration}}

Pour manipuler les données on utilisera les packages suivants:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyverse)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## -- Attaching core tidyverse packages ------------------------ tidyverse 2.0.0 --
## v dplyr     1.1.4     v readr     2.1.5
## v forcats   1.0.0     v stringr   1.5.1
## v ggplot2   3.5.1     v tibble    3.2.1
## v lubridate 1.9.3     v tidyr     1.3.1
## v purrr     1.0.2     
## -- Conflicts ------------------------------------------ tidyverse_conflicts() --
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()
## i Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(readxl)}
\FunctionTok{library}\NormalTok{(sf)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Linking to GEOS 3.11.2, GDAL 3.8.2, PROJ 9.3.1; sf_use_s2() is TRUE
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(mapsf)}
\FunctionTok{library}\NormalTok{(modelr)}
\end{Highlighting}
\end{Shaded}

On va utiliser les nouveaux packages suivants:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(jtools)}
\FunctionTok{library}\NormalTok{(huxtable)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Attachement du package : 'huxtable'
\end{verbatim}

\begin{verbatim}
## L'objet suivant est masqué depuis 'package:dplyr':
## 
##     add_rownames
\end{verbatim}

\begin{verbatim}
## L'objet suivant est masqué depuis 'package:ggplot2':
## 
##     theme_grey
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(ggstats)}
\FunctionTok{library}\NormalTok{(performance)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Attachement du package : 'performance'
\end{verbatim}

\begin{verbatim}
## Les objets suivants sont masqués depuis 'package:huxtable':
## 
##     print_html, print_md
\end{verbatim}

\begin{verbatim}
## Les objets suivants sont masqués depuis 'package:modelr':
## 
##     mae, mse, rmse
\end{verbatim}

Pour réaliser cet exemple, on utilisera les données issues d'un scraping
de Immoweb des logements à louer pour Bruxelles. Les adresses ont été
géocodées avec Phacochr.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{loyers\_data}\OtherTok{\textless{}{-}}\FunctionTok{read\_delim}\NormalTok{(}\StringTok{"data/immoweb\_louer.csv"}\NormalTok{, }\AttributeTok{delim =} \StringTok{";"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Rows: 17735 Columns: 9
## -- Column specification --------------------------------------------------------
## Delimiter: ";"
## chr  (4): type, PEB, nb_chambres, cd_sector
## dbl  (4): surface, loyer, x_31370, y_31370
## dttm (1): date_request
## 
## i Use `spec()` to retrieve the full column specification for this data.
## i Specify the column types or set `show_col_types = FALSE` to quiet this message.
\end{verbatim}

\hypertarget{analyse-de-ruxe9gression}{%
\section{Analyse de régression}\label{analyse-de-ruxe9gression}}

\hypertarget{visualiser-et-supprimer-les-outliers}{%
\subsection{Visualiser et supprimer les outliers}\label{visualiser-et-supprimer-les-outliers}}

On peut analyser la relation entre la variable loyer et la variable
surface, on peut simplement réaliser un graphique avec un geom\_point:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{loyers\_data }\SpecialCharTok{\%\textgreater{}\%}
\FunctionTok{ggplot}\NormalTok{( }\FunctionTok{aes}\NormalTok{(surface, loyer)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{alpha=}\FloatTok{0.5}\NormalTok{,}\AttributeTok{cex=}\DecValTok{1}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: Removed 2066 rows containing missing values or values outside the scale range
## (`geom_point()`).
\end{verbatim}

\includegraphics{manuel_geo_quanti_files/figure-latex/unnamed-chunk-4-1.pdf}

Pour analyser la relation entre les deux variables, il peut être utile
de supprimer les valeurs abérantes (outliers). Ceci peut se faire de
façon simple en retirant 1\% de chaque côté de la distribution en
appliquant un filtre et en conservant les loyer par surface supérieur au
quantile 0.01 et inférieur au quantile 0.99:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{loyers\_data}\OtherTok{\textless{}{-}}\NormalTok{ loyers\_data }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(}
\NormalTok{    loyer }\SpecialCharTok{\textgreater{}} \FunctionTok{quantile}\NormalTok{(loyer, }\AttributeTok{prob =} \FloatTok{0.01}\NormalTok{, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
\NormalTok{    loyer }\SpecialCharTok{\textless{}} \FunctionTok{quantile}\NormalTok{(loyer, }\AttributeTok{prob =} \FloatTok{0.99}\NormalTok{, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
\NormalTok{    surface }\SpecialCharTok{\textgreater{}} \FunctionTok{quantile}\NormalTok{(surface, }\AttributeTok{prob =} \FloatTok{0.01}\NormalTok{, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
\NormalTok{    surface }\SpecialCharTok{\textless{}} \FunctionTok{quantile}\NormalTok{(surface, }\AttributeTok{prob =} \FloatTok{0.99}\NormalTok{, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

Pour supprimer les outliers, il est possible également d'utiliser de
filtre plus ``réfléchi'' en analysant les données ou en utilisant des
méthodes plus complexes :
\url{https://delladata.fr/comment-detecter-les-outliers-avec-r/}

On peut alors revisualiser les données et on observe une relation
beaucoup plus claire:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{loyers\_data }\SpecialCharTok{\%\textgreater{}\%}
    \FunctionTok{ggplot}\NormalTok{( }\FunctionTok{aes}\NormalTok{(surface, loyer)) }\SpecialCharTok{+}
    \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{alpha=}\FloatTok{0.3}\NormalTok{,}\AttributeTok{cex=}\FloatTok{0.5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{manuel_geo_quanti_files/figure-latex/unnamed-chunk-6-1.pdf}

On peut ajouter une droite de régression sur le graphique grâce à
geom\_smooth:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{loyers\_data }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggplot}\NormalTok{( }\FunctionTok{aes}\NormalTok{(surface, loyer)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{alpha=}\FloatTok{0.3}\NormalTok{,}\AttributeTok{cex=}\FloatTok{0.5}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{formula =}\NormalTok{ y }\SpecialCharTok{\textasciitilde{}}\NormalTok{ x, }\AttributeTok{method =} \StringTok{"lm"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{manuel_geo_quanti_files/figure-latex/unnamed-chunk-7-1.pdf}

\hypertarget{ruxe9gression-simple}{%
\subsection{Régression simple}\label{ruxe9gression-simple}}

On peut réaliser une analyse de régression grâce à la fonction lm où Y =
aX +b ce traduit par Y \textasciitilde{} X. Dans notre cas, on tente d'évaluer le loyer
(Y) en fonction de la surface (X):

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{model1}\OtherTok{\textless{}{-}}\FunctionTok{lm}\NormalTok{(loyer }\SpecialCharTok{\textasciitilde{}}\NormalTok{ surface, }\AttributeTok{data=}\NormalTok{loyers\_data)}
\end{Highlighting}
\end{Shaded}

Pour afficher un résumé des résultats on utilise la fonction summary sur
l'objet créer par la fonction lm:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(model1)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = loyer ~ surface, data = loyers_data)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4328.9  -210.7   -50.8   147.6  3883.4 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(>|t|)    
## (Intercept) 385.3549     7.0466   54.69   <2e-16 ***
## surface      11.1933     0.0557  200.97   <2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 435.8 on 15222 degrees of freedom
## Multiple R-squared:  0.7263, Adjusted R-squared:  0.7263 
## F-statistic: 4.039e+04 on 1 and 15222 DF,  p-value: < 2.2e-16
\end{verbatim}

Notez que l'objet model est un objet list qui contient une série de
choses qu'il est possible d'aller chercher grâce au \$ :
model1\(coefficients les coefficients model1\)residuals les résidus
model1\$fitted.values les valeurs prédites

De même il est possible d'aller rechercher des éléments du résultat de
summary appliqué sur le modèle: summary(model1)\$r.squared le R²

\hypertarget{ruxe9gression-multiple}{%
\subsection{Régression multiple}\label{ruxe9gression-multiple}}

On peut décider de rajouter des variables dans le modèle en modifiant la
formule Y = X1 + X2 + X3 + \ldots{}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{model2}\OtherTok{\textless{}{-}}\FunctionTok{lm}\NormalTok{(loyer }\SpecialCharTok{\textasciitilde{}}\NormalTok{ surface }\SpecialCharTok{+}\NormalTok{  type }\SpecialCharTok{+}\NormalTok{ PEB }\SpecialCharTok{+}\NormalTok{ nb\_chambres, }\AttributeTok{data=}\NormalTok{loyers\_data)}
\FunctionTok{summary}\NormalTok{(model2)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = loyer ~ surface + type + PEB + nb_chambres, data = loyers_data)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4185.1  -212.7   -38.6   154.0  2892.6 
## 
## Coefficients:
##                Estimate Std. Error t value Pr(>|t|)    
## (Intercept)    408.4328    27.3727  14.921  < 2e-16 ***
## surface         11.1487     0.1127  98.950  < 2e-16 ***
## typeHOUSE       21.0105    19.6294   1.070 0.284480    
## PEBB           102.9783    23.7831   4.330 1.50e-05 ***
## PEBC            11.3038    22.9773   0.492 0.622762    
## PEBD           -69.1262    22.7818  -3.034 0.002417 ** 
## PEBE           -82.0685    23.5270  -3.488 0.000488 ***
## PEBF          -118.1271    25.2917  -4.671 3.04e-06 ***
## PEBG           -99.2732    24.5295  -4.047 5.22e-05 ***
## nb_chambres1   -12.0105    19.0896  -0.629 0.529254    
## nb_chambres2     4.8550    19.6849   0.247 0.805194    
## nb_chambres3   156.4296    23.2023   6.742 1.64e-11 ***
## nb_chambres4    79.7030    31.7783   2.508 0.012153 *  
## nb_chambres5+ -135.7740    42.2787  -3.211 0.001325 ** 
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 410.4 on 11090 degrees of freedom
##   (4120 observations effacées parce que manquantes)
## Multiple R-squared:  0.7633, Adjusted R-squared:  0.763 
## F-statistic:  2751 on 13 and 11090 DF,  p-value: < 2.2e-16
\end{verbatim}

\hypertarget{ruxe9gression-polynomiale}{%
\subsection{Régression polynomiale}\label{ruxe9gression-polynomiale}}

\hypertarget{logarithme}{%
\subsubsection{Logarithme}\label{logarithme}}

Plutôt que de modéliser loyer en fonction de la surface, on pourrait
avoir envie de modéliser le loyer selon le logarithme de la surface.

Alors on soit créer une nouvelle variable et réaliser la régression:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{loyers\_data}\SpecialCharTok{$}\NormalTok{log\_surface }\OtherTok{\textless{}{-}} \FunctionTok{log}\NormalTok{(loyers\_data}\SpecialCharTok{$}\NormalTok{surface)}

\NormalTok{model3}\OtherTok{\textless{}{-}} \FunctionTok{lm}\NormalTok{(loyer }\SpecialCharTok{\textasciitilde{}}\NormalTok{ log\_surface }\SpecialCharTok{+}\NormalTok{  type }\SpecialCharTok{+}\NormalTok{ PEB }\SpecialCharTok{+}\NormalTok{ nb\_chambres, }\AttributeTok{data=}\NormalTok{loyers\_data)}
\FunctionTok{summary}\NormalTok{(model3)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = loyer ~ log_surface + type + PEB + nb_chambres, 
##     data = loyers_data)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -3415.2  -263.3   -50.6   200.8  2883.8 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(>|t|)    
## (Intercept)   -4067.02      67.47 -60.282  < 2e-16 ***
## log_surface    1320.08      16.31  80.923  < 2e-16 ***
## typeHOUSE        98.95      21.29   4.649 3.38e-06 ***
## PEBB             92.62      25.88   3.578 0.000347 ***
## PEBC             11.21      25.01   0.448 0.653853    
## PEBD            -56.46      24.79  -2.277 0.022783 *  
## PEBE            -67.66      25.60  -2.643 0.008226 ** 
## PEBF           -105.00      27.52  -3.816 0.000137 ***
## PEBG            -72.71      26.68  -2.725 0.006443 ** 
## nb_chambres1   -281.90      21.42 -13.161  < 2e-16 ***
## nb_chambres2   -458.09      24.36 -18.804  < 2e-16 ***
## nb_chambres3   -249.66      29.24  -8.538  < 2e-16 ***
## nb_chambres4   -137.41      37.64  -3.650 0.000263 ***
## nb_chambres5+   130.42      46.17   2.825 0.004743 ** 
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 446.6 on 11090 degrees of freedom
##   (4120 observations effacées parce que manquantes)
## Multiple R-squared:  0.7198, Adjusted R-squared:  0.7194 
## F-statistic:  2191 on 13 and 11090 DF,  p-value: < 2.2e-16
\end{verbatim}

soit indiquer le logarithme directement dans la formule du lm

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{model3}\OtherTok{\textless{}{-}} \FunctionTok{lm}\NormalTok{(loyer }\SpecialCharTok{\textasciitilde{}} \FunctionTok{log}\NormalTok{(surface) }\SpecialCharTok{+}\NormalTok{  type }\SpecialCharTok{+}\NormalTok{ PEB }\SpecialCharTok{+}\NormalTok{ nb\_chambres, }\AttributeTok{data=}\NormalTok{loyers\_data)}
\FunctionTok{summary}\NormalTok{(model3)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = loyer ~ log(surface) + type + PEB + nb_chambres, 
##     data = loyers_data)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -3415.2  -263.3   -50.6   200.8  2883.8 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(>|t|)    
## (Intercept)   -4067.02      67.47 -60.282  < 2e-16 ***
## log(surface)   1320.08      16.31  80.923  < 2e-16 ***
## typeHOUSE        98.95      21.29   4.649 3.38e-06 ***
## PEBB             92.62      25.88   3.578 0.000347 ***
## PEBC             11.21      25.01   0.448 0.653853    
## PEBD            -56.46      24.79  -2.277 0.022783 *  
## PEBE            -67.66      25.60  -2.643 0.008226 ** 
## PEBF           -105.00      27.52  -3.816 0.000137 ***
## PEBG            -72.71      26.68  -2.725 0.006443 ** 
## nb_chambres1   -281.90      21.42 -13.161  < 2e-16 ***
## nb_chambres2   -458.09      24.36 -18.804  < 2e-16 ***
## nb_chambres3   -249.66      29.24  -8.538  < 2e-16 ***
## nb_chambres4   -137.41      37.64  -3.650 0.000263 ***
## nb_chambres5+   130.42      46.17   2.825 0.004743 ** 
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 446.6 on 11090 degrees of freedom
##   (4120 observations effacées parce que manquantes)
## Multiple R-squared:  0.7198, Adjusted R-squared:  0.7194 
## F-statistic:  2191 on 13 and 11090 DF,  p-value: < 2.2e-16
\end{verbatim}

On peut faire un graphique de la façon suivante:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{loyers\_data }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggplot}\NormalTok{( }\FunctionTok{aes}\NormalTok{(surface, loyer)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{alpha=}\FloatTok{0.3}\NormalTok{,}\AttributeTok{cex=}\FloatTok{0.5}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{formula =}\NormalTok{ y }\SpecialCharTok{\textasciitilde{}} \FunctionTok{log}\NormalTok{(x), }\AttributeTok{method =} \StringTok{"lm"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{manuel_geo_quanti_files/figure-latex/unnamed-chunk-13-1.pdf}

\hypertarget{division}{%
\subsubsection{Division}\label{division}}

On peut vouloir modéliser le loyer par surface en fonction de la
surface:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{loyers\_data }\OtherTok{\textless{}{-}}\NormalTok{ loyers\_data }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{loyer\_surface=}\NormalTok{ loyer}\SpecialCharTok{/}\NormalTok{surface,}
         \AttributeTok{inv\_surface=} \DecValTok{1}\SpecialCharTok{/}\NormalTok{surface)}

\NormalTok{model4}\OtherTok{\textless{}{-}} \FunctionTok{lm}\NormalTok{(loyer\_surface }\SpecialCharTok{\textasciitilde{}}\NormalTok{ inv\_surface }\SpecialCharTok{+}\NormalTok{  type }\SpecialCharTok{+}\NormalTok{ PEB }\SpecialCharTok{+}\NormalTok{ nb\_chambres, }\AttributeTok{data=}\NormalTok{loyers\_data)}
\FunctionTok{summary}\NormalTok{(model4)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = loyer_surface ~ inv_surface + type + PEB + nb_chambres, 
##     data = loyers_data)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -11.2378  -2.1955  -0.4891   1.6736  31.3294 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(>|t|)    
## (Intercept)     8.3490     0.3133  26.647  < 2e-16 ***
## inv_surface   513.5564     9.6383  53.283  < 2e-16 ***
## typeHOUSE       0.3212     0.1522   2.111   0.0348 *  
## PEBB            0.8469     0.1857   4.561 5.14e-06 ***
## PEBC           -0.0173     0.1793  -0.097   0.9231    
## PEBD           -0.7036     0.1776  -3.961 7.51e-05 ***
## PEBE           -0.9432     0.1835  -5.139 2.80e-07 ***
## PEBF           -1.1262     0.1973  -5.708 1.17e-08 ***
## PEBG           -1.3072     0.1915  -6.827 9.11e-12 ***
## nb_chambres1    0.9402     0.1631   5.765 8.38e-09 ***
## nb_chambres2    1.8815     0.1948   9.659  < 2e-16 ***
## nb_chambres3    3.2194     0.2225  14.472  < 2e-16 ***
## nb_chambres4    3.0069     0.2709  11.099  < 2e-16 ***
## nb_chambres5+   2.3830     0.3180   7.494 7.17e-14 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 3.204 on 11090 degrees of freedom
##   (4120 observations effacées parce que manquantes)
## Multiple R-squared:  0.3567, Adjusted R-squared:  0.356 
## F-statistic: 473.1 on 13 and 11090 DF,  p-value: < 2.2e-16
\end{verbatim}

Le graphique avec le I dans le formule:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{loyers\_data }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggplot}\NormalTok{( }\FunctionTok{aes}\NormalTok{(surface, loyer\_surface)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{alpha=}\FloatTok{0.3}\NormalTok{,}\AttributeTok{cex=}\FloatTok{0.5}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{formula =}\NormalTok{ y }\SpecialCharTok{\textasciitilde{}} \FunctionTok{I}\NormalTok{(}\DecValTok{1}\SpecialCharTok{/}\NormalTok{x), }\AttributeTok{method =} \StringTok{"lm"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{manuel_geo_quanti_files/figure-latex/unnamed-chunk-15-1.pdf}

\hypertarget{exposants}{%
\subsubsection{Exposants}\label{exposants}}

On pourrait directement placer ces changements dans la formule mais
alors il faut utiliser la fonction I() qui permet de réaliser ces
opérations. La fonction I ( ``come si'' / ``as is'') permet d'indiquer qu'il
s'agit d'une formule et non pas une opération sur un vecteur et le \textasciitilde{}
``est dépendant de''.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{model5}\OtherTok{\textless{}{-}} \FunctionTok{lm}\NormalTok{(loyer}\SpecialCharTok{\textasciitilde{}}\NormalTok{ surface }\SpecialCharTok{+} \FunctionTok{I}\NormalTok{(surface}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{) }\SpecialCharTok{+}\NormalTok{  type }\SpecialCharTok{+}\NormalTok{ PEB }\SpecialCharTok{+}\NormalTok{ nb\_chambres, }\AttributeTok{data=}\NormalTok{loyers\_data)}
\FunctionTok{summary}\NormalTok{(model5)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = loyer ~ surface + I(surface^2) + type + PEB + nb_chambres, 
##     data = loyers_data)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4072.8  -213.4   -37.2   159.6  2881.1 
## 
## Coefficients:
##                 Estimate Std. Error t value Pr(>|t|)    
## (Intercept)    3.562e+02  2.943e+01  12.105  < 2e-16 ***
## surface        1.259e+01  3.200e-01  39.332  < 2e-16 ***
## I(surface^2)  -3.933e-03  8.187e-04  -4.804 1.58e-06 ***
## typeHOUSE      2.305e+01  1.961e+01   1.175 0.239960    
## PEBB           9.977e+01  2.377e+01   4.197 2.72e-05 ***
## PEBC           6.240e+00  2.298e+01   0.272 0.785963    
## PEBD          -7.414e+01  2.278e+01  -3.254 0.001141 ** 
## PEBE          -8.608e+01  2.352e+01  -3.660 0.000253 ***
## PEBF          -1.216e+02  2.528e+01  -4.811 1.52e-06 ***
## PEBG          -1.019e+02  2.451e+01  -4.156 3.27e-05 ***
## nb_chambres1  -3.119e+01  1.948e+01  -1.601 0.109455    
## nb_chambres2  -4.329e+01  2.207e+01  -1.961 0.049890 *  
## nb_chambres3   9.303e+01  2.667e+01   3.488 0.000489 ***
## nb_chambres4   1.865e+01  3.420e+01   0.545 0.585428    
## nb_chambres5+ -1.391e+02  4.224e+01  -3.293 0.000993 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 410 on 11089 degrees of freedom
##   (4120 observations effacées parce que manquantes)
## Multiple R-squared:  0.7638, Adjusted R-squared:  0.7635 
## F-statistic:  2561 on 14 and 11089 DF,  p-value: < 2.2e-16
\end{verbatim}

le graphique, de nouveau il faut bien utiliser I dans la formule:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{loyers\_data }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggplot}\NormalTok{( }\FunctionTok{aes}\NormalTok{(surface, loyer)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{alpha=}\FloatTok{0.3}\NormalTok{,}\AttributeTok{cex=}\FloatTok{0.5}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{formula =}\NormalTok{ y }\SpecialCharTok{\textasciitilde{}} \FunctionTok{I}\NormalTok{(x}\SpecialCharTok{+}\NormalTok{x}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{), }\AttributeTok{method =} \StringTok{"lm"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{manuel_geo_quanti_files/figure-latex/unnamed-chunk-17-1.pdf}

\hypertarget{visualisation}{%
\subsection{Visualisation}\label{visualisation}}

Il existe beaucoup de package pour faciliter la visualisation des
résultats. \# Par exemple pour visualiser rapidement le résultat de
plusieurs modèle jtools permet de réaliser un tableau synthétique utile:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(jtools)}
\FunctionTok{export\_summs}\NormalTok{(model1, model2, model3, model4, model5)}
\end{Highlighting}
\end{Shaded}

 
  \providecommand{\huxb}[2]{\arrayrulecolor[RGB]{#1}\global\arrayrulewidth=#2pt}
  \providecommand{\huxvb}[2]{\color[RGB]{#1}\vrule width #2pt}
  \providecommand{\huxtpad}[1]{\rule{0pt}{#1}}
  \providecommand{\huxbpad}[1]{\rule[-#1]{0pt}{#1}}

\begin{table}[ht]
\begin{centerbox}
\begin{threeparttable}
 \setlength{\tabcolsep}{0pt}
\begin{tabular}{l l l l l l}


\hhline{>{\huxb{0, 0, 0}{0.8}}->{\huxb{0, 0, 0}{0.8}}->{\huxb{0, 0, 0}{0.8}}->{\huxb{0, 0, 0}{0.8}}->{\huxb{0, 0, 0}{0.8}}->{\huxb{0, 0, 0}{0.8}}-}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}c!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\centering \hspace{6pt}  \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{c!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\centering \hspace{6pt} Model 1 \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{c!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\centering \hspace{6pt} Model 2 \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{c!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\centering \hspace{6pt} Model 3 \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{c!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\centering \hspace{6pt} Model 4 \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{c!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\centering \hspace{6pt} Model 5 \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{>{\huxb{255, 255, 255}{0.4}}->{\huxb{0, 0, 0}{0.4}}->{\huxb{0, 0, 0}{0.4}}->{\huxb{0, 0, 0}{0.4}}->{\huxb{0, 0, 0}{0.4}}->{\huxb{0, 0, 0}{0.4}}-}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt} (Intercept) \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 385.35 *** \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 408.43 *** \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} -4067.02 *** \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 8.35 *** \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 356.21 *** \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt}  \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (7.05)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (27.37)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (67.47)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (0.31)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (29.43)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt} surface \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 11.19 *** \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 11.15 *** \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 12.59 *** \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt}  \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (0.06)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (0.11)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (0.32)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt} typeHOUSE \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 21.01\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 98.95 *** \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 0.32 *\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 23.05\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt}  \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (19.63)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (21.29)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (0.15)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (19.61)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt} PEBB \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 102.98 *** \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 92.62 *** \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 0.85 *** \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 99.77 *** \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt}  \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (23.78)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (25.88)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (0.19)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (23.77)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt} PEBC \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 11.30\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 11.21\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} -0.02\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 6.24\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt}  \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (22.98)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (25.01)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (0.18)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (22.98)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt} PEBD \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} -69.13 **\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} -56.46 *\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} -0.70 *** \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} -74.14 **\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt}  \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (22.78)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (24.79)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (0.18)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (22.78)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt} PEBE \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} -82.07 *** \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} -67.66 **\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} -0.94 *** \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} -86.08 *** \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt}  \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (23.53)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (25.60)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (0.18)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (23.52)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt} PEBF \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} -118.13 *** \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} -105.00 *** \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} -1.13 *** \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} -121.61 *** \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt}  \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (25.29)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (27.52)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (0.20)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (25.28)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt} PEBG \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} -99.27 *** \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} -72.71 **\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} -1.31 *** \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} -101.86 *** \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt}  \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (24.53)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (26.68)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (0.19)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (24.51)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt} nb\_chambres1 \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} -12.01\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} -281.90 *** \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 0.94 *** \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} -31.19\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt}  \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (19.09)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (21.42)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (0.16)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (19.48)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt} nb\_chambres2 \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 4.86\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} -458.09 *** \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 1.88 *** \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} -43.29 *\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt}  \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (19.68)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (24.36)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (0.19)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (22.07)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt} nb\_chambres3 \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 156.43 *** \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} -249.66 *** \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 3.22 *** \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 93.03 *** \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt}  \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (23.20)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (29.24)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (0.22)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (26.67)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt} nb\_chambres4 \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 79.70 *\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} -137.41 *** \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 3.01 *** \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 18.65\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt}  \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (31.78)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (37.64)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (0.27)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (34.20)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt} nb\_chambres5+ \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} -135.77 **\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 130.42 **\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 2.38 *** \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} -139.12 *** \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt}  \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (42.28)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (46.17)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (0.32)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (42.24)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt} log(surface) \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 1320.08 *** \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt}  \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (16.31)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt} inv\_surface \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 513.56 *** \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt}  \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (9.64)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt} I(surface\textasciicircum 2) \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} -0.00 *** \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt}  \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (0.00)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{>{\huxb{255, 255, 255}{0.4}}->{\huxb{0, 0, 0}{0.4}}->{\huxb{0, 0, 0}{0.4}}->{\huxb{0, 0, 0}{0.4}}->{\huxb{0, 0, 0}{0.4}}->{\huxb{0, 0, 0}{0.4}}-}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt} N \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 15224\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 11104\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 11104\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 11104\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 11104\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt} R2 \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 0.73\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 0.76\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 0.72\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 0.36\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 0.76\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{>{\huxb{0, 0, 0}{0.8}}->{\huxb{0, 0, 0}{0.8}}->{\huxb{0, 0, 0}{0.8}}->{\huxb{0, 0, 0}{0.8}}->{\huxb{0, 0, 0}{0.8}}->{\huxb{0, 0, 0}{0.8}}-}
\arrayrulecolor{black}

\multicolumn{6}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt}  *** p $<$ 0.001;  ** p $<$ 0.01;  * p $<$ 0.05. \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}
\end{tabular}
\end{threeparttable}\par\end{centerbox}

\end{table}
 

On peut également exporter ce résultat en format pdf de la façon
suivante:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# export\_summs(model1, model2,model3, model4,to.file = "html", file.name = "TP08/tableau\_regression.html")}
\end{Highlighting}
\end{Shaded}

On peut visualiser un forest plot de cette façon grâce au package
ggstats:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(ggstats)}
\FunctionTok{ggcoef\_model}\NormalTok{(model2)}
\end{Highlighting}
\end{Shaded}

\includegraphics{manuel_geo_quanti_files/figure-latex/unnamed-chunk-20-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggcoef\_table}\NormalTok{(model2)}
\end{Highlighting}
\end{Shaded}

\includegraphics{manuel_geo_quanti_files/figure-latex/unnamed-chunk-20-2.pdf}

voir ici pour plus de détails: \textless{}
\url{https://cran.r-project.org/web/packages/ggstats/vignettes/ggcoef_model.htm}
\textgreater{}

\hypertarget{ruxe9aliser-les-tests-des-hypothuxe8ses}{%
\subsection{Réaliser les tests des hypothèses}\label{ruxe9aliser-les-tests-des-hypothuxe8ses}}

La réalisation de modèle de régression s'appuie sur une série
d'hypothèses qu'il s'agit de vérifier dont: - la linéarité des
résidus, - la constance de la variance des résidus, - la faible
influence d'outliers, - la non colinéarité entre les variables
explicatives, - la normalité des résidus.

\textless{} \url{https://easystats.github.io/performance/index.html} \textgreater{}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(performance)}
\CommentTok{\#png("TP08/check\_model.png", height= 1000, width=1000)}
\FunctionTok{check\_model}\NormalTok{(model2)}
\end{Highlighting}
\end{Shaded}

\includegraphics{manuel_geo_quanti_files/figure-latex/unnamed-chunk-21-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#dev.off()}
\end{Highlighting}
\end{Shaded}

\hypertarget{analyse-guxe9ographique}{%
\section{Analyse géographique}\label{analyse-guxe9ographique}}

\hypertarget{analyse-guxe9ographique-simple}{%
\subsection{Analyse géographique simple}\label{analyse-guxe9ographique-simple}}

On peut réaliser une carte du loyer moyen par secteur statistique. On
calculer par secteur statistique le nombre d'annonces et le loyer moyen:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{loyer\_moyen}\OtherTok{\textless{}{-}}\NormalTok{loyers\_data}\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(cd\_sector) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}
    \AttributeTok{n=}\FunctionTok{n}\NormalTok{(),}
    \AttributeTok{loy\_moyen=} \FunctionTok{mean}\NormalTok{(loyer, }\AttributeTok{na.rm=}\NormalTok{T)}
\NormalTok{  )}
\end{Highlighting}
\end{Shaded}

On charge les secteurs statistiques

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{secteurs\_stats}\OtherTok{\textless{}{-}} \FunctionTok{st\_read}\NormalTok{ (}\StringTok{"data/sh\_statbel\_statistical\_sectors\_31370\_20230101.gpkg"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Reading layer `secteurs_stats2023' from data source 
##   `C:\Users\hugop\Nextcloud\git\manuel_geo_quanti\data\sh_statbel_statistical_sectors_31370_20230101.gpkg' 
##   using driver `GPKG'
## Simple feature collection with 19795 features and 31 fields
## Geometry type: MULTIPOLYGON
## Dimension:     XY
## Bounding box:  xmin: 21991.63 ymin: 21162.16 xmax: 295167.1 ymax: 244027.2
## Projected CRS: BD72 / Belgian Lambert 72
\end{verbatim}

On fait une jointure entre le résultat du calcul précédent et les
secteurs statistiques

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{loyer\_moyen\_sec}\OtherTok{\textless{}{-}}\NormalTok{secteurs\_stats }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{left\_join}\NormalTok{(loyer\_moyen, }\AttributeTok{by=}\FunctionTok{c}\NormalTok{(}\StringTok{"cd\_sector"}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(tx\_rgn\_descr\_fr}\SpecialCharTok{==}\StringTok{"Région de Bruxelles{-}Capitale"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

On réalise la carte

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{mf\_map}\NormalTok{(}\AttributeTok{x =}\NormalTok{ loyer\_moyen\_sec,}\AttributeTok{col =} \StringTok{"white"}\NormalTok{, }\AttributeTok{border =} \StringTok{"grey"}\NormalTok{)}
\FunctionTok{mf\_map}\NormalTok{(loyer\_moyen\_sec,}
       \AttributeTok{var=} \FunctionTok{c}\NormalTok{(}\StringTok{"n"}\NormalTok{, }\StringTok{"loy\_moyen"}\NormalTok{),}
       \AttributeTok{type=}\StringTok{"prop\_choro"}\NormalTok{,}
       \AttributeTok{pal=} \StringTok{"Viridis"}\NormalTok{,}
       \AttributeTok{inches=}\FloatTok{0.14}\NormalTok{,}
       \AttributeTok{nbreaks=}\DecValTok{5}\NormalTok{,}
       \AttributeTok{add=}\NormalTok{T)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 196 'NA' values are not plotted on the map.
\end{verbatim}

\includegraphics{manuel_geo_quanti_files/figure-latex/unnamed-chunk-25-1.pdf}

\hypertarget{cartographier-les-ruxe9sidus}{%
\subsection{Cartographier les résidus}\label{cartographier-les-ruxe9sidus}}

Les résidus de la régression se trouve dans l'objet model produit par la
fonction lm. Néanmoins il s'agit d'un objet list où le valeur manquantes
ont été supprimée. Le package modelr permet de faire facilement la
jointure entre les données de base et les résidus et calculer une
moyenne des résidus par secteurs statistiques:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(modelr)}

\NormalTok{resid}\OtherTok{\textless{}{-}}\NormalTok{loyers\_data }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{add\_residuals}\NormalTok{( model2) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(cd\_sector) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{moyenne\_residus=} \FunctionTok{mean}\NormalTok{(resid, }\AttributeTok{na.rm=}\NormalTok{T),}
            \AttributeTok{n=}\FunctionTok{n}\NormalTok{())}
\end{Highlighting}
\end{Shaded}

On joint les résidus au fichier des secteurs statistiques

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{resid\_sec}\OtherTok{\textless{}{-}}\NormalTok{secteurs\_stats}\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{left\_join}\NormalTok{(resid, }\AttributeTok{by=}\FunctionTok{c}\NormalTok{(}\StringTok{"cd\_sector"}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(tx\_rgn\_descr\_fr}\SpecialCharTok{==}\StringTok{"Région de Bruxelles{-}Capitale"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

On fait une carte des résidus moyen par secteurs stats

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{mf\_map}\NormalTok{(}\AttributeTok{x =}\NormalTok{ resid\_sec,}\AttributeTok{col =} \StringTok{"white"}\NormalTok{, }\AttributeTok{border =} \StringTok{"grey"}\NormalTok{)}
\FunctionTok{mf\_map}\NormalTok{(resid\_sec,}
       \AttributeTok{var=} \FunctionTok{c}\NormalTok{(}\StringTok{"n"}\NormalTok{, }\StringTok{"moyenne\_residus"}\NormalTok{),}
       \AttributeTok{type=}\StringTok{"prop\_choro"}\NormalTok{,}
       \AttributeTok{pal=} \StringTok{"Viridis"}\NormalTok{,}
       \AttributeTok{inches=}\FloatTok{0.15}\NormalTok{,}
       \AttributeTok{nbreaks=}\DecValTok{5}\NormalTok{,}
       \AttributeTok{add=}\NormalTok{T)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 196 'NA' values are not plotted on the map.
\end{verbatim}

\includegraphics{manuel_geo_quanti_files/figure-latex/unnamed-chunk-28-1.pdf}

On peut alors observer là où le loyer est en moyenne pus élevé ou moins
élevé que prédit par le modèle.

\hypertarget{ajouter-une-variable-guxe9ographique}{%
\subsection{Ajouter une variable géographique}\label{ajouter-une-variable-guxe9ographique}}

On peut ajouter une variable géographique comme l'indice de difficulté
par secteur statistique de 2010 pour Bruxelles qui une bonne
approximation de la division sociale de l'espace bruxellois:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{indice }\OtherTok{\textless{}{-}} \FunctionTok{read\_delim}\NormalTok{(}\StringTok{"data/indice\_synthetique.csv"}\NormalTok{, }\AttributeTok{delim=} \StringTok{";"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Rows: 7752 Columns: 2
## -- Column specification --------------------------------------------------------
## Delimiter: ";"
## chr (1): Secteur statistique
## dbl (1): Indice synthétique de difficulté 2010
## 
## i Use `spec()` to retrieve the full column specification for this data.
## i Specify the column types or set `show_col_types = FALSE` to quiet this message.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{indice\_sec}\OtherTok{\textless{}{-}}\NormalTok{secteurs\_stats}\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{left\_join}\NormalTok{(indice, }\AttributeTok{by=}\FunctionTok{c}\NormalTok{(}\StringTok{"cd\_sector"}\OtherTok{=}\StringTok{"Secteur statistique"}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(tx\_rgn\_descr\_fr}\SpecialCharTok{==}\StringTok{"Région de Bruxelles{-}Capitale"}\NormalTok{)}

\FunctionTok{mf\_map}\NormalTok{(indice\_sec,}
       \AttributeTok{var=}\StringTok{"Indice synthétique de difficulté 2010"}\NormalTok{,}
       \AttributeTok{type=}\StringTok{"choro"}\NormalTok{,}
       \AttributeTok{pal=} \StringTok{"Viridis"}\NormalTok{,}
       \AttributeTok{nbreaks=}\DecValTok{5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{manuel_geo_quanti_files/figure-latex/unnamed-chunk-29-1.pdf}

On peut alors ajouter cet indice dans un troisième modèle. Pour réaliser
ceci on doit d'abord joindre les données

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{loyers\_data}\OtherTok{\textless{}{-}}\NormalTok{loyers\_data }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{left\_join}\NormalTok{(indice, }\AttributeTok{by=}\FunctionTok{c}\NormalTok{(}\StringTok{"cd\_sector"}\OtherTok{=}\StringTok{"Secteur statistique"}\NormalTok{))}

\NormalTok{model6}\OtherTok{\textless{}{-}}\FunctionTok{lm}\NormalTok{(loyer }\SpecialCharTok{\textasciitilde{}}\NormalTok{ surface }\SpecialCharTok{+}\NormalTok{ PEB}\SpecialCharTok{+}\NormalTok{type}\SpecialCharTok{+}\NormalTok{nb\_chambres }\SpecialCharTok{+}\StringTok{\textasciigrave{}}\AttributeTok{Indice synthétique de difficulté 2010}\StringTok{\textasciigrave{}}\NormalTok{, }\AttributeTok{data=}\NormalTok{loyers\_data)}

\FunctionTok{export\_summs}\NormalTok{(model1, model2, model6)}
\end{Highlighting}
\end{Shaded}

 
  \providecommand{\huxb}[2]{\arrayrulecolor[RGB]{#1}\global\arrayrulewidth=#2pt}
  \providecommand{\huxvb}[2]{\color[RGB]{#1}\vrule width #2pt}
  \providecommand{\huxtpad}[1]{\rule{0pt}{#1}}
  \providecommand{\huxbpad}[1]{\rule[-#1]{0pt}{#1}}

\begin{table}[ht]
\begin{centerbox}
\begin{threeparttable}
 \setlength{\tabcolsep}{0pt}
\begin{tabular}{l l l l}


\hhline{>{\huxb{0, 0, 0}{0.8}}->{\huxb{0, 0, 0}{0.8}}->{\huxb{0, 0, 0}{0.8}}->{\huxb{0, 0, 0}{0.8}}-}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}c!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\centering \hspace{6pt}  \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{c!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\centering \hspace{6pt} Model 1 \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{c!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\centering \hspace{6pt} Model 2 \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{c!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\centering \hspace{6pt} Model 3 \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{>{\huxb{255, 255, 255}{0.4}}->{\huxb{0, 0, 0}{0.4}}->{\huxb{0, 0, 0}{0.4}}->{\huxb{0, 0, 0}{0.4}}-}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt} (Intercept) \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 385.35 *** \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 408.43 *** \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 504.53 *** \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt}  \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (7.05)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (27.37)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (36.16)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt} surface \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 11.19 *** \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 11.15 *** \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 9.58 *** \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt}  \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (0.06)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (0.11)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (0.16)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt} typeHOUSE \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 21.01\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 75.26 **\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt}  \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (19.63)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (25.58)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt} PEBB \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 102.98 *** \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 90.67 **\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt}  \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (23.78)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (30.53)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt} PEBC \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 11.30\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} -30.36\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt}  \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (22.98)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (29.94)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt} PEBD \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} -69.13 **\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} -79.09 **\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt}  \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (22.78)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (29.90)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt} PEBE \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} -82.07 *** \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} -111.85 *** \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt}  \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (23.53)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (30.57)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt} PEBF \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} -118.13 *** \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} -119.83 *** \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt}  \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (25.29)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (32.58)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt} PEBG \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} -99.27 *** \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} -138.68 *** \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt}  \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (24.53)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (31.69)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt} nb\_chambres1 \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} -12.01\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 7.97\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt}  \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (19.09)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (23.97)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt} nb\_chambres2 \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 4.86\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 73.96 **\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt}  \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (19.68)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (24.99)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt} nb\_chambres3 \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 156.43 *** \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 250.02 *** \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt}  \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (23.20)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (29.66)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt} nb\_chambres4 \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 79.70 *\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 283.29 *** \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt}  \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (31.78)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (40.85)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt} nb\_chambres5+ \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} -135.77 **\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 75.90\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt}  \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (42.28)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (54.97)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt} `Indice synthétique de difficulté 2010` \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 4.95\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt}  \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} \hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} (6.16)\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{>{\huxb{255, 255, 255}{0.4}}->{\huxb{0, 0, 0}{0.4}}->{\huxb{0, 0, 0}{0.4}}->{\huxb{0, 0, 0}{0.4}}-}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt} N \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 15224\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 11104\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 5981\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}

\multicolumn{1}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt} R2 \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 0.73\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 0.76\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} &
\multicolumn{1}{r!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedleft \hspace{6pt} 0.73\hphantom{0}\hphantom{0}\hphantom{0}\hphantom{0} \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{>{\huxb{0, 0, 0}{0.8}}->{\huxb{0, 0, 0}{0.8}}->{\huxb{0, 0, 0}{0.8}}->{\huxb{0, 0, 0}{0.8}}-}
\arrayrulecolor{black}

\multicolumn{4}{!{\huxvb{0, 0, 0}{0}}l!{\huxvb{0, 0, 0}{0}}}{\huxtpad{6pt + 1em}\raggedright \hspace{6pt}  *** p $<$ 0.001;  ** p $<$ 0.01;  * p $<$ 0.05. \hspace{6pt}\huxbpad{6pt}} \tabularnewline[-0.5pt]


\hhline{}
\arrayrulecolor{black}
\end{tabular}
\end{threeparttable}\par\end{centerbox}

\end{table}
 

Notez que ici le modèle semble se détériorer puisque le R2 diminue. Ceci
peut s'expliquer par le fait que le modèle est réaliser sur un nombre
plus petit de variables.

\hypertarget{analyse-de-corruxe9lation-spatiale}{%
\subsection{Analyse de corrélation spatiale}\label{analyse-de-corruxe9lation-spatiale}}

On peut également réaliser des régressions sur des entités spatiales.
Ici on prend les données expulisions et on va analyser la correlation
avec la division sociale de l'espace et les cantons pour mesurer un
possible ``effet juge''.

On importe les données:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{expulsions }\OtherTok{\textless{}{-}} \FunctionTok{read\_delim}\NormalTok{(}\StringTok{"data/expulsions\_2018\_secteursstat.csv"}\NormalTok{, }\AttributeTok{delim=} \StringTok{";"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Rows: 698 Columns: 7
## -- Column specification --------------------------------------------------------
## Delimiter: ";"
## chr (1): ID_SS_bis
## dbl (6): ID_SS, exp_ais, exp_individu, exp_public, exp_société, exp_total
## 
## i Use `spec()` to retrieve the full column specification for this data.
## i Specify the column types or set `show_col_types = FALSE` to quiet this message.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{indice }\OtherTok{\textless{}{-}} \FunctionTok{read\_delim}\NormalTok{(}\StringTok{"data/indice\_synthetique.csv"}\NormalTok{, }\AttributeTok{delim=} \StringTok{";"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Rows: 7752 Columns: 2
## -- Column specification --------------------------------------------------------
## Delimiter: ";"
## chr (1): Secteur statistique
## dbl (1): Indice synthétique de difficulté 2010
## 
## i Use `spec()` to retrieve the full column specification for this data.
## i Specify the column types or set `show_col_types = FALSE` to quiet this message.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{logements }\OtherTok{\textless{}{-}} \FunctionTok{read\_excel}\NormalTok{(}\StringTok{"data/census\_2011\_logements.xls"}\NormalTok{)}
\NormalTok{secteurs\_stats}\OtherTok{\textless{}{-}} \FunctionTok{st\_read}\NormalTok{ (}\StringTok{"data/sh\_statbel\_statistical\_sectors\_31370\_20230101.gpkg"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Reading layer `secteurs_stats2023' from data source 
##   `C:\Users\hugop\Nextcloud\git\manuel_geo_quanti\data\sh_statbel_statistical_sectors_31370_20230101.gpkg' 
##   using driver `GPKG'
## Simple feature collection with 19795 features and 31 fields
## Geometry type: MULTIPOLYGON
## Dimension:     XY
## Bounding box:  xmin: 21991.63 ymin: 21162.16 xmax: 295167.1 ymax: 244027.2
## Projected CRS: BD72 / Belgian Lambert 72
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{cantons}\OtherTok{\textless{}{-}} \FunctionTok{st\_read}\NormalTok{ (}\StringTok{"data/cantons\_judiciaires\_bxl\_2018.gpkg"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{st\_zm}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Reading layer `cantons_bxl_2018' from data source 
##   `C:\Users\hugop\Nextcloud\git\manuel_geo_quanti\data\cantons_judiciaires_bxl_2018.gpkg' 
##   using driver `GPKG'
## Simple feature collection with 20 features and 2 fields
## Geometry type: MULTIPOLYGON
## Dimension:     XYZ
## Bounding box:  xmin: 141192.7 ymin: 161464.7 xmax: 158003.9 ymax: 178175.9
## z_range:       zmin: 0 zmax: 0
## Projected CRS: BD72 / Belgian Lambert 72
\end{verbatim}

On réalise la jointure spatiale entre les canton et les centroïdes des
secteurs statistiques:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{canton\_secteurs}\OtherTok{\textless{}{-}}\NormalTok{cantons }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{st\_join}\NormalTok{(}\FunctionTok{st\_point\_on\_surface}\NormalTok{(secteurs\_stats), }\AttributeTok{join=}\NormalTok{ st\_intersects) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{as.data.frame}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(CANTON, cd\_sector)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: st_point_on_surface assumes attributes are constant over geometries
\end{verbatim}

\hypertarget{analyse-visuelle}{%
\subsubsection{Analyse visuelle}\label{analyse-visuelle}}

On peut réaliser une cartographie des trois jeux de données

\hypertarget{les-expulsions}{%
\paragraph{Les expulsions}\label{les-expulsions}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{secteurs\_stats\_epulsions}\OtherTok{\textless{}{-}}\NormalTok{secteurs\_stats }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{left\_join}\NormalTok{(expulsions,  }\AttributeTok{by=}\FunctionTok{c}\NormalTok{(}\StringTok{"cd\_sector"}\OtherTok{=}\StringTok{"ID\_SS\_bis"}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{left\_join}\NormalTok{(logements, }\AttributeTok{by=} \FunctionTok{c}\NormalTok{(}\StringTok{"cd\_sector"}\OtherTok{=}\StringTok{"Secteur statistique"}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(tx\_rgn\_descr\_fr}\SpecialCharTok{==}\StringTok{"Région de Bruxelles{-}Capitale"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{tx\_expulsion=}\DecValTok{100}\SpecialCharTok{*}\NormalTok{exp\_total }\SpecialCharTok{/}\StringTok{\textasciigrave{}}\AttributeTok{Logements loués}\StringTok{\textasciigrave{}}\NormalTok{)}

\FunctionTok{mf\_map}\NormalTok{(}\AttributeTok{x =}\NormalTok{ secteurs\_stats\_epulsions,}\AttributeTok{col =} \StringTok{"white"}\NormalTok{, }\AttributeTok{border =} \StringTok{"grey"}\NormalTok{)}
\FunctionTok{mf\_map}\NormalTok{(secteurs\_stats\_epulsions,}
       \AttributeTok{var=}\FunctionTok{c}\NormalTok{(}\StringTok{"exp\_total"}\NormalTok{, }\StringTok{"tx\_expulsion"}\NormalTok{),}
       \AttributeTok{type=}\StringTok{"prop\_choro"}\NormalTok{,}
       \AttributeTok{pal=} \StringTok{"Viridis"}\NormalTok{,}
       \AttributeTok{inches=}\FloatTok{0.11}\NormalTok{,}
       \AttributeTok{nbreaks=}\DecValTok{5}\NormalTok{,}
       \AttributeTok{add=}\NormalTok{T)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 26 'NA' values are not plotted on the map.
\end{verbatim}

\begin{verbatim}
## 140 '0' values are not plotted on the map.
\end{verbatim}

\includegraphics{manuel_geo_quanti_files/figure-latex/unnamed-chunk-33-1.pdf}

\hypertarget{les-cantons}{%
\paragraph{Les cantons:}\label{les-cantons}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{secteurs\_stats\_cantons}\OtherTok{\textless{}{-}}\NormalTok{secteurs\_stats }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{left\_join}\NormalTok{(canton\_secteurs, }\AttributeTok{by=}\StringTok{"cd\_sector"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(tx\_rgn\_descr\_fr}\SpecialCharTok{==}\StringTok{"Région de Bruxelles{-}Capitale"}\NormalTok{)}

\FunctionTok{mf\_map}\NormalTok{(secteurs\_stats\_cantons,}
       \AttributeTok{var=} \StringTok{"CANTON"}\NormalTok{,}
       \AttributeTok{type=}\StringTok{"typo"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{manuel_geo_quanti_files/figure-latex/unnamed-chunk-34-1.pdf}

\hypertarget{lindice-synthuxe9tique-de-difficultuxe9}{%
\paragraph{L'indice synthétique de difficulté:}\label{lindice-synthuxe9tique-de-difficultuxe9}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{secteurs\_stats\_indice}\OtherTok{\textless{}{-}}\NormalTok{secteurs\_stats }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{left\_join}\NormalTok{(indice, }\AttributeTok{by=} \FunctionTok{c}\NormalTok{(}\StringTok{"cd\_sector"}\OtherTok{=}\StringTok{"Secteur statistique"}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(tx\_rgn\_descr\_fr}\SpecialCharTok{==}\StringTok{"Région de Bruxelles{-}Capitale"}\NormalTok{)}

\FunctionTok{mf\_map}\NormalTok{(secteurs\_stats\_indice,}
       \AttributeTok{var=} \StringTok{"Indice synthétique de difficulté 2010"}\NormalTok{,}
       \AttributeTok{type=}\StringTok{"choro"}\NormalTok{,}
       \AttributeTok{pal=} \StringTok{"Viridis"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{manuel_geo_quanti_files/figure-latex/unnamed-chunk-35-1.pdf}

\hypertarget{ruxe9gression}{%
\subsubsection{Régression}\label{ruxe9gression}}

On réalise les jointures, on calcul un taux d'expulsions et on ne garde
que les secteurs statistiques bruxellois qui ont plus de 200 logements
loués

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{secteurs\_stats\_expulsions}\OtherTok{\textless{}{-}}\NormalTok{secteurs\_stats }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{left\_join}\NormalTok{(expulsions, }\AttributeTok{by=}\FunctionTok{c}\NormalTok{(}\StringTok{"cd\_sector"}\OtherTok{=}\StringTok{"ID\_SS\_bis"}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{left\_join}\NormalTok{(logements, }\AttributeTok{by=} \FunctionTok{c}\NormalTok{(}\StringTok{"cd\_sector"}\OtherTok{=}\StringTok{"Secteur statistique"}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{left\_join}\NormalTok{(indice, }\AttributeTok{by=} \FunctionTok{c}\NormalTok{(}\StringTok{"cd\_sector"}\OtherTok{=}\StringTok{"Secteur statistique"}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{left\_join}\NormalTok{(canton\_secteurs,}\AttributeTok{by=} \FunctionTok{c}\NormalTok{(}\StringTok{"cd\_sector"}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{tx\_expulsion=}\DecValTok{100}\SpecialCharTok{*}\NormalTok{exp\_total }\SpecialCharTok{/}\StringTok{\textasciigrave{}}\AttributeTok{Logements loués}\StringTok{\textasciigrave{}}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(tx\_rgn\_descr\_fr}\SpecialCharTok{==}\StringTok{"Région de Bruxelles{-}Capitale"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{ (}\StringTok{\textasciigrave{}}\AttributeTok{Logements loués}\StringTok{\textasciigrave{}}\SpecialCharTok{\textgreater{}}\DecValTok{200}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

On peut analyser le lien entre indice synthétique et le taux
d'expulsion:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{secteurs\_stats\_expulsions}\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggplot}\NormalTok{( }\FunctionTok{aes}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Indice synthétique de difficulté 2010}\StringTok{\textasciigrave{}}\NormalTok{, tx\_expulsion)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{alpha=}\FloatTok{0.3}\NormalTok{,}\AttributeTok{cex=}\FloatTok{0.5}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{formula =}\NormalTok{ y }\SpecialCharTok{\textasciitilde{}}\NormalTok{ x, }\AttributeTok{method =} \StringTok{"lm"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{manuel_geo_quanti_files/figure-latex/unnamed-chunk-37-1.pdf}

Et réaliser une régression

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{model1}\OtherTok{\textless{}{-}}\FunctionTok{lm}\NormalTok{(tx\_expulsion}\SpecialCharTok{\textasciitilde{}} \StringTok{\textasciigrave{}}\AttributeTok{Indice synthétique de difficulté 2010}\StringTok{\textasciigrave{}}\NormalTok{,}\AttributeTok{data=}\NormalTok{ secteurs\_stats\_expulsions )}
\FunctionTok{summary}\NormalTok{(model1)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = tx_expulsion ~ `Indice synthétique de difficulté 2010`, 
##     data = secteurs_stats_expulsions)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.49704 -0.43992 -0.08241  0.37774  2.96598 
## 
## Coefficients:
##                                         Estimate Std. Error t value Pr(>|t|)
## (Intercept)                              1.15698    0.04469  25.887  < 2e-16
## `Indice synthétique de difficulté 2010`  0.15447    0.03208   4.815 2.02e-06
##                                            
## (Intercept)                             ***
## `Indice synthétique de difficulté 2010` ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.6788 on 450 degrees of freedom
## Multiple R-squared:  0.04899,    Adjusted R-squared:  0.04688 
## F-statistic: 23.18 on 1 and 450 DF,  p-value: 2.018e-06
\end{verbatim}

On peut à nouveau cartographier les résidus

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{secteurs\_stats\_expulsions1}\OtherTok{\textless{}{-}}\NormalTok{secteurs\_stats\_expulsions }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{add\_residuals}\NormalTok{( model1)}

\FunctionTok{mf\_map}\NormalTok{(}\AttributeTok{x =} \FunctionTok{filter}\NormalTok{(secteurs\_stats, tx\_rgn\_descr\_fr}\SpecialCharTok{==}\StringTok{"Région de Bruxelles{-}Capitale"}\NormalTok{),}
       \AttributeTok{col =} \StringTok{"white"}\NormalTok{, }\AttributeTok{border =} \StringTok{"grey"}\NormalTok{)}
\FunctionTok{mf\_map}\NormalTok{(secteurs\_stats\_expulsions1,}
       \AttributeTok{var=}\FunctionTok{c}\NormalTok{(}\StringTok{"exp\_total"}\NormalTok{, }\StringTok{"resid"}\NormalTok{),}
       \AttributeTok{type=}\StringTok{"prop\_choro"}\NormalTok{,}
       \AttributeTok{pal=} \StringTok{"Viridis"}\NormalTok{,}
       \AttributeTok{inches=}\FloatTok{0.11}\NormalTok{,}
       \AttributeTok{nbreaks=}\DecValTok{5}\NormalTok{,}
       \AttributeTok{add=}\NormalTok{T)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 11 '0' values are not plotted on the map.
\end{verbatim}

\includegraphics{manuel_geo_quanti_files/figure-latex/unnamed-chunk-39-1.pdf}

On peut pondéré la régression par le nombre de logements loués. Dans le
cas où on a des entités de tailles très différentes cela peut avoir du
sens

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{model2}\OtherTok{\textless{}{-}}\FunctionTok{lm}\NormalTok{(tx\_expulsion}\SpecialCharTok{\textasciitilde{}} \StringTok{\textasciigrave{}}\AttributeTok{Indice synthétique de difficulté 2010}\StringTok{\textasciigrave{}}\NormalTok{, }\AttributeTok{weights =} \StringTok{\textasciigrave{}}\AttributeTok{Logements loués}\StringTok{\textasciigrave{}}\NormalTok{,}\AttributeTok{data=}\NormalTok{ secteurs\_stats\_expulsions )}
\FunctionTok{summary}\NormalTok{(model2)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = tx_expulsion ~ `Indice synthétique de difficulté 2010`, 
##     data = secteurs_stats_expulsions, weights = `Logements loués`)
## 
## Weighted Residuals:
##      Min       1Q   Median       3Q      Max 
## -110.573   -9.817   -1.243    9.429   63.777 
## 
## Coefficients:
##                                         Estimate Std. Error t value Pr(>|t|)
## (Intercept)                              1.17420    0.04720  24.879  < 2e-16
## `Indice synthétique de difficulté 2010`  0.10944    0.03095   3.536 0.000448
##                                            
## (Intercept)                             ***
## `Indice synthétique de difficulté 2010` ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 16.14 on 450 degrees of freedom
## Multiple R-squared:  0.02704,    Adjusted R-squared:  0.02488 
## F-statistic:  12.5 on 1 and 450 DF,  p-value: 0.000448
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{secteurs\_stats\_expulsions}\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggplot}\NormalTok{( }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\StringTok{\textasciigrave{}}\AttributeTok{Indice synthétique de difficulté 2010}\StringTok{\textasciigrave{}}\NormalTok{,}\AttributeTok{y=}\NormalTok{ tx\_expulsion)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{alpha=}\FloatTok{0.3}\NormalTok{, }\FunctionTok{aes}\NormalTok{( }\AttributeTok{size=} \StringTok{\textasciigrave{}}\AttributeTok{Logements loués}\StringTok{\textasciigrave{}}\NormalTok{ ) )}\SpecialCharTok{+}
  \FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{formula =}\NormalTok{ y }\SpecialCharTok{\textasciitilde{}}\NormalTok{ x, }\AttributeTok{method =} \StringTok{"lm"}\NormalTok{, }\AttributeTok{mapping =} \FunctionTok{aes}\NormalTok{(}\AttributeTok{weight =} \StringTok{\textasciigrave{}}\AttributeTok{Logements loués}\StringTok{\textasciigrave{}}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\includegraphics{manuel_geo_quanti_files/figure-latex/unnamed-chunk-40-1.pdf}

On peut ajouter la variable canton pour mesurer ``l'effet juge''

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{model3}\OtherTok{\textless{}{-}}\FunctionTok{lm}\NormalTok{(tx\_expulsion}\SpecialCharTok{\textasciitilde{}} \StringTok{\textasciigrave{}}\AttributeTok{Indice synthétique de difficulté 2010}\StringTok{\textasciigrave{}}\SpecialCharTok{+}\NormalTok{ CANTON,}\AttributeTok{data=}\NormalTok{ secteurs\_stats\_expulsions )}

\FunctionTok{library}\NormalTok{(ggstats)}
\FunctionTok{ggcoef\_table}\NormalTok{(model3)}
\end{Highlighting}
\end{Shaded}

\includegraphics{manuel_geo_quanti_files/figure-latex/unnamed-chunk-41-1.pdf}

\hypertarget{analyse-en-composantes-principales}{%
\chapter{Analyse en Composantes Principales}\label{analyse-en-composantes-principales}}

\hypertarget{objectifs}{%
\section{Objectifs}\label{objectifs}}

L'objectif de ce TP est de réaliser une analyse en composante principale sur base de données électorales.

\hypertarget{donnuxe9es}{%
\section{Données}\label{donnuxe9es}}

\begin{itemize}
\tightlist
\item
  données des élections présidentielles 2022 par communes : pres2022comm.csv (\url{https://unehistoireduconflitpolitique.fr/telecharger.html})
\end{itemize}

Ce fichier contient les résultats des élections présidentielles de 2022 en format csv. Ces fichiers ont été générés à partir des résultats électoraux disponibles sur le site du Ministère de l'Intérieur et sur data.gouv.fr. J. Cagé et T. Piketty (2023) : Une histoire du conflit politique. Élections et inégalités sociales en France, 1789-2022. Le Seuil.

\begin{itemize}
\item
  communes: communes-20220101.shp (1)
\item
  arrondissement municipaux: arrondissements\_municipaux-20180711.shp (2)
\item
  table commune - région : commune2021.csv (3)
\item
  revenus par commune : FILO2021\_DEC\_COM.xlsx (4)
\item
  population par commune: population\_insee\_2021.xlsx (5)
\end{itemize}

\begin{enumerate}
\def\labelenumi{(\arabic{enumi})}
\tightlist
\item
  INSEE: \url{https://www.data.gouv.fr/fr/datasets/decoupage-administratif-communal-francais-issu-d-openstreetmap/}
\item
  INSEE: \url{https://www.data.gouv.fr/fr/datasets/decoupage-administratif-communal-francais-issu-d-openstreetmap/}
\item
  INSEE: \url{https://www.insee.fr/fr/information/2560452}
\item
  INSEE: \url{https://www.insee.fr/fr/statistiques/7756855?sommaire=7756859}
\item
  INSEE : \url{https://www.insee.fr/fr/statistiques/7739582?sommaire=7728826}
\end{enumerate}

Pour ce TP nous utiliserons les packages suivants:

De façon maintenant habituelle:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyverse)}
\FunctionTok{library}\NormalTok{(sf)}
\FunctionTok{library}\NormalTok{(mapsf)}
\FunctionTok{library}\NormalTok{(readxl)}
\FunctionTok{library}\NormalTok{(remotes) }
\end{Highlighting}
\end{Shaded}

Et deux packages développés pour réaliser des ACP et visualiser les résultats:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#install\_version("estimability", "1.4.1")}
\CommentTok{\#install.packages("FactoMineR") }
\CommentTok{\#install.packages("factoextra")}
\FunctionTok{library}\NormalTok{(FactoMineR)}
\FunctionTok{library}\NormalTok{(factoextra)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Welcome! Want to learn more? See two factoextra-related books at https://goo.gl/ve3WBa
\end{verbatim}

Les objectifs pour réaliser une ACP sont généralement :

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  Débroussailler un large set de données avec plein de variables
\item
  Réaliser un indicateur synthétique
\item
  Préparer à une classification
\end{enumerate}

Dans le cas ici, on va plutôt réaliser une ACP suivant le premier objectif sur les votes exprimés aux élections en Île de France aux élections présidentielles de 2022. L'objectif sera de voir on retrouve des structures dans la géographie de cette élection.

\hypertarget{importation-des-donnuxe9es}{%
\subsection{Importation des données}\label{importation-des-donnuxe9es}}

\hypertarget{uxe9lections-2022}{%
\subsubsection{Élections 2022}\label{uxe9lections-2022}}

Importation des données:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{data}\OtherTok{\textless{}{-}}\FunctionTok{read\_delim}\NormalTok{(}\StringTok{"data/France/pres2022comm.csv"}\NormalTok{, }\AttributeTok{delim=}\StringTok{","}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\DecValTok{19}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(codecommune}\SpecialCharTok{!=}\StringTok{"75056"}\NormalTok{) }\CommentTok{\# \%\textgreater{}\% \# On enlève la communes de Paris}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Rows: 34867 Columns: 97
## -- Column specification --------------------------------------------------------
## Delimiter: ","
## chr  (4): dep, nomdep, codecommune, nomcommune
## dbl (93): inscrits, votants, exprimes, voixARTHAUD, voixPOUTOU, voixROUSSEL,...
## 
## i Use `spec()` to retrieve the full column specification for this data.
## i Specify the column types or set `show_col_types = FALSE` to quiet this message.
\end{verbatim}

On prend une table pour ne sélectionner que l'Île de France:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{communes\_table}\OtherTok{\textless{}{-}}\FunctionTok{read\_delim}\NormalTok{(}\StringTok{"data/France/commune2021.csv"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Rows: 37742 Columns: 12
## -- Column specification --------------------------------------------------------
## Delimiter: ","
## chr (11): TYPECOM, COM, REG, DEP, CTCD, ARR, NCC, NCCENR, LIBELLE, CAN, COMP...
## dbl  (1): TNCC
## 
## i Use `spec()` to retrieve the full column specification for this data.
## i Specify the column types or set `show_col_types = FALSE` to quiet this message.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{data}\OtherTok{\textless{}{-}}\NormalTok{data }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{left\_join}\NormalTok{(communes\_table, }\AttributeTok{by=}\FunctionTok{c}\NormalTok{(}\StringTok{"codecommune"}\OtherTok{=}\StringTok{"COM"}\NormalTok{))}\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(REG}\SpecialCharTok{==}\DecValTok{11}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(}\SpecialCharTok{{-}}\FunctionTok{c}\NormalTok{(}\DecValTok{20}\SpecialCharTok{:}\DecValTok{30}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\hypertarget{communes}{%
\subsubsection{Communes}\label{communes}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{communes}\OtherTok{\textless{}{-}} \FunctionTok{st\_read}\NormalTok{(}\StringTok{"data/France/communes\_arrond\_ile\_de\_france.gpkg"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(insee}\SpecialCharTok{!=}\StringTok{"75056"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Reading layer `communes_arrond_ile_de_france' from data source 
##   `C:\Users\hugop\Nextcloud\git\manuel_geo_quanti\data\France\communes_arrond_ile_de_france.gpkg' 
##   using driver `GPKG'
## Simple feature collection with 1287 features and 4 fields
## Geometry type: MULTIPOLYGON
## Dimension:     XY
## Bounding box:  xmin: 1.446244 ymin: 48.12015 xmax: 3.559221 ymax: 49.24143
## Geodetic CRS:  WGS 84
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# On importe les arrondissements de Paris, Lyon et Marseille}
\NormalTok{arrond\_lyon\_mars\_paris}\OtherTok{\textless{}{-}} \FunctionTok{st\_read}\NormalTok{(}\StringTok{"data/France/arrondissements\_municipaux{-}20180711{-}shp/arrondissements\_municipaux{-}20180711.shp"}\NormalTok{)}\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{surf\_km2) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{rename}\NormalTok{(}\AttributeTok{geom=}\NormalTok{geometry)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Reading layer `arrondissements_municipaux-20180711' from data source 
##   `C:\Users\hugop\Nextcloud\git\manuel_geo_quanti\data\France\arrondissements_municipaux-20180711-shp\arrondissements_municipaux-20180711.shp' 
##   using driver `ESRI Shapefile'
## Simple feature collection with 45 features and 4 fields
## Geometry type: MULTIPOLYGON
## Dimension:     XY
## Bounding box:  xmin: 2.224122 ymin: 43.19714 xmax: 5.532476 ymax: 48.90216
## Geodetic CRS:  WGS 84
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{communes}\OtherTok{\textless{}{-}}\FunctionTok{bind\_rows}\NormalTok{(communes,arrond\_lyon\_mars\_paris) }\CommentTok{\# On joint communes et arrondissements}
\FunctionTok{rm}\NormalTok{(arrond\_lyon\_mars\_paris)}
\end{Highlighting}
\end{Shaded}

On ne garde que les communes de l'Ile de France:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{communes}\OtherTok{\textless{}{-}}\NormalTok{communes }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{left\_join}\NormalTok{(communes\_table, }\AttributeTok{by=}\FunctionTok{c}\NormalTok{(}\StringTok{"insee"}\OtherTok{=}\StringTok{"COM"}\NormalTok{))}\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(REG}\SpecialCharTok{==}\DecValTok{11}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(}\SpecialCharTok{{-}}\FunctionTok{c}\NormalTok{(}\DecValTok{5}\SpecialCharTok{:}\DecValTok{15}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning in sf_column %in% names(g): Detected an unexpected many-to-many relationship between `x` and `y`.
## i Row 17 of `x` matches multiple rows in `y`.
## i Row 31675 of `y` matches multiple rows in `x`.
## i If a many-to-many relationship is expected, set `relationship =
##   "many-to-many"` to silence this warning.
\end{verbatim}

On calcul la densité par communes:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{communes}\OtherTok{\textless{}{-}}\NormalTok{communes }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{surface=}\FunctionTok{as.numeric}\NormalTok{(}\FunctionTok{st\_area}\NormalTok{(geom))}\SpecialCharTok{/}\DecValTok{10000}\NormalTok{) }\CommentTok{\# On calcul le superficie de chaque communes}
\end{Highlighting}
\end{Shaded}

On créé un objet département pour la cartographie:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{departements\_Paris}\OtherTok{\textless{}{-}}\NormalTok{communes }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{left\_join}\NormalTok{(communes\_table, }\AttributeTok{by=}\FunctionTok{c}\NormalTok{(}\StringTok{"insee"}\OtherTok{=}\StringTok{"COM"}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(REG}\SpecialCharTok{==}\DecValTok{11}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(DEP,REG) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{geom=}\FunctionTok{st\_union}\NormalTok{(geom))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning in sf_column %in% names(g): Detected an unexpected many-to-many relationship between `x` and `y`.
## i Row 17 of `x` matches multiple rows in `y`.
## i Row 31675 of `y` matches multiple rows in `x`.
## i If a many-to-many relationship is expected, set `relationship =
##   "many-to-many"` to silence this warning.
\end{verbatim}

\begin{verbatim}
## `summarise()` has grouped output by 'DEP'. You can override using the `.groups`
## argument.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{rm}\NormalTok{(communes\_table)}
\end{Highlighting}
\end{Shaded}

\hypertarget{recodage}{%
\subsection{Recodage}\label{recodage}}

Pour réaliser l'ACP il faut d'abord recoder les variables. On utilise généralement des variables en proportion:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{data}\OtherTok{\textless{}{-}}\NormalTok{data }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{ARTHAUD=}\NormalTok{voixARTHAUD}\SpecialCharTok{/}\NormalTok{exprimes,}
         \AttributeTok{POUTOU=}\NormalTok{voixPOUTOU}\SpecialCharTok{/}\NormalTok{exprimes,}
         \AttributeTok{ROUSSEL=}\NormalTok{voixROUSSEL}\SpecialCharTok{/}\NormalTok{exprimes,}
         \AttributeTok{MELENCHON=}\NormalTok{voixMELENCHON}\SpecialCharTok{/}\NormalTok{exprimes,}
         \AttributeTok{JADOT=}\NormalTok{voixJADOT}\SpecialCharTok{/}\NormalTok{exprimes,}
         \AttributeTok{HIDALGO=}\NormalTok{voixHIDALGO}\SpecialCharTok{/}\NormalTok{exprimes,}
         \AttributeTok{LASSALLE=}\NormalTok{voixLASSALLE}\SpecialCharTok{/}\NormalTok{exprimes,}
         \AttributeTok{MACRON=}\NormalTok{voixMACRON}\SpecialCharTok{/}\NormalTok{exprimes,}
         \AttributeTok{PECRESSE=}\NormalTok{voixPECRESSE}\SpecialCharTok{/}\NormalTok{exprimes,}
         \AttributeTok{ZEMMOUR=}\NormalTok{voixZEMMOUR}\SpecialCharTok{/}\NormalTok{exprimes,}
         \AttributeTok{DUPONTAIGNAN=}\NormalTok{voixDUPONTAIGNAN}\SpecialCharTok{/}\NormalTok{exprimes,}
         \AttributeTok{MLEPEN=}\NormalTok{voixMLEPEN}\SpecialCharTok{/}\NormalTok{exprimes)}


\CommentTok{\# De façon raccourcie, il est possible de réaliser de la façon suivante:}

\CommentTok{\# {-} en utilisant des pivot (tidyr) et un group by}
\CommentTok{\# data\textless{}{-}data \%\textgreater{}\%}
\CommentTok{\#   pivot\_longer(cols= 8:19,names\_to ="candidat", values\_to = "voix" ) \%\textgreater{}\%}
\CommentTok{\#   mutate(voix=voix/exprimes) \%\textgreater{}\%}
\CommentTok{\#   pivot\_wider(values\_from = "voix", names\_from = "candidat")}

\CommentTok{\# {-} de façon encore plus synthétique, en utilisant un across:}
\CommentTok{\# data\textless{}{-}data \%\textgreater{}\%}
\CommentTok{\#  mutate(across(8:19, \textasciitilde{} . /exprimes))}
\end{Highlighting}
\end{Shaded}

\hypertarget{premiuxe8re-visualisation-des-donnuxe9es}{%
\section{Première visualisation des données}\label{premiuxe8re-visualisation-des-donnuxe9es}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{communes\_voix}\OtherTok{\textless{}{-}}\NormalTok{communes }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{left\_join}\NormalTok{(data, }\AttributeTok{by=}\FunctionTok{c}\NormalTok{(}\StringTok{"insee"}\OtherTok{=}\StringTok{"codecommune"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\hypertarget{une-carte-par-variable}{%
\subsection{Une carte par variable}\label{une-carte-par-variable}}

On peut réaliser une carte pour chaque candidat:

\begin{Shaded}
\begin{Highlighting}[]
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{12}\SpecialCharTok{:}\DecValTok{23}\NormalTok{) \{}
  \CommentTok{\# mf\_export(x = communes\_voix ,}
  \CommentTok{\#           filename =paste0("TP09/cartes\_candidats/carte\_",names(communes\_voix)[i],".png" ),}
  \CommentTok{\#           width = 900)}
  \FunctionTok{mf\_map}\NormalTok{(}\AttributeTok{x =}\NormalTok{ communes\_voix, }\AttributeTok{col =} \ConstantTok{NA}\NormalTok{, }\AttributeTok{border =} \StringTok{"gray25"}\NormalTok{, }\AttributeTok{lwd =} \FloatTok{0.1}\NormalTok{)}
  \FunctionTok{mf\_map}\NormalTok{(}\AttributeTok{x =}\NormalTok{ departements\_Paris, }\AttributeTok{col =} \ConstantTok{NA}\NormalTok{, }\AttributeTok{border =} \StringTok{"gray25"}\NormalTok{, }\AttributeTok{lwd =} \DecValTok{1}\NormalTok{, }\AttributeTok{add=}\NormalTok{T)}
  \FunctionTok{mf\_map}\NormalTok{(communes\_voix ,}
         \AttributeTok{var=} \FunctionTok{c}\NormalTok{(}\FunctionTok{names}\NormalTok{(communes\_voix)[i], }\FunctionTok{names}\NormalTok{(communes\_voix)[i}\SpecialCharTok{+}\DecValTok{12}\NormalTok{]),}
         \CommentTok{\#val\_max=max(unlist(communes\_voix[,11:22])),}
         \AttributeTok{type=}\StringTok{"prop\_choro"}\NormalTok{,}
         \AttributeTok{pal=}\StringTok{"Viridis"}\NormalTok{,}
         \AttributeTok{inches=}\FloatTok{0.1}\NormalTok{,}
         \AttributeTok{add=}\NormalTok{T)}
  \CommentTok{\#dev.off()}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 184 '0' values are not plotted on the map.
\end{verbatim}

\includegraphics{manuel_geo_quanti_files/figure-latex/unnamed-chunk-52-1.pdf}

\begin{verbatim}
## 101 '0' values are not plotted on the map.
\end{verbatim}

\includegraphics{manuel_geo_quanti_files/figure-latex/unnamed-chunk-52-2.pdf}

\begin{verbatim}
## 42 '0' values are not plotted on the map.
\end{verbatim}

\includegraphics{manuel_geo_quanti_files/figure-latex/unnamed-chunk-52-3.pdf} \includegraphics{manuel_geo_quanti_files/figure-latex/unnamed-chunk-52-4.pdf}

\begin{verbatim}
## 8 '0' values are not plotted on the map.
\end{verbatim}

\includegraphics{manuel_geo_quanti_files/figure-latex/unnamed-chunk-52-5.pdf}

\begin{verbatim}
## 97 '0' values are not plotted on the map.
\end{verbatim}

\includegraphics{manuel_geo_quanti_files/figure-latex/unnamed-chunk-52-6.pdf}

\begin{verbatim}
## 18 '0' values are not plotted on the map.
\end{verbatim}

\includegraphics{manuel_geo_quanti_files/figure-latex/unnamed-chunk-52-7.pdf} \includegraphics{manuel_geo_quanti_files/figure-latex/unnamed-chunk-52-8.pdf} \includegraphics{manuel_geo_quanti_files/figure-latex/unnamed-chunk-52-9.pdf} \includegraphics{manuel_geo_quanti_files/figure-latex/unnamed-chunk-52-10.pdf}

\begin{verbatim}
## 19 '0' values are not plotted on the map.
\end{verbatim}

\includegraphics{manuel_geo_quanti_files/figure-latex/unnamed-chunk-52-11.pdf} \includegraphics{manuel_geo_quanti_files/figure-latex/unnamed-chunk-52-12.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{rm}\NormalTok{(i)}
\end{Highlighting}
\end{Shaded}

\hypertarget{matrice-de-corruxe9lation}{%
\subsection{Matrice de corrélation}\label{matrice-de-corruxe9lation}}

On peut réaliser une matrice de corrélation:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{cor.mat }\OtherTok{\textless{}{-}} \FunctionTok{round}\NormalTok{(}\FunctionTok{cor}\NormalTok{(data[,}\DecValTok{20}\SpecialCharTok{:}\DecValTok{31}\NormalTok{], }\AttributeTok{use=}\StringTok{"complete.obs"}\NormalTok{),}\DecValTok{2}\NormalTok{) }\CommentTok{\# round(,2) permet d\textquotesingle{}arrondir à deux décimale et use="complete.obs" permet d\textquotesingle{}exclure les NA}
\NormalTok{cor.mat}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##              ARTHAUD POUTOU ROUSSEL MELENCHON JADOT HIDALGO LASSALLE MACRON
## ARTHAUD         1.00   0.09    0.05      0.05 -0.16   -0.04     0.08  -0.29
## POUTOU          0.09   1.00    0.14      0.00 -0.06   -0.03     0.10  -0.24
## ROUSSEL         0.05   0.14    1.00      0.17 -0.01    0.12     0.01  -0.22
## MELENCHON       0.05   0.00    0.17      1.00 -0.15    0.11    -0.35  -0.29
## JADOT          -0.16  -0.06   -0.01     -0.15  1.00    0.33    -0.06   0.58
## HIDALGO        -0.04  -0.03    0.12      0.11  0.33    1.00    -0.07   0.20
## LASSALLE        0.08   0.10    0.01     -0.35 -0.06   -0.07     1.00  -0.17
## MACRON         -0.29  -0.24   -0.22     -0.29  0.58    0.20    -0.17   1.00
## PECRESSE       -0.13  -0.07   -0.26     -0.54  0.06   -0.11     0.08   0.25
## ZEMMOUR        -0.07  -0.13   -0.27     -0.53  0.10   -0.14     0.14   0.25
## DUPONTAIGNAN    0.05   0.06    0.09     -0.29 -0.07   -0.11     0.16  -0.16
## MLEPEN          0.20   0.17    0.03     -0.40 -0.54   -0.31     0.31  -0.68
##              PECRESSE ZEMMOUR DUPONTAIGNAN MLEPEN
## ARTHAUD         -0.13   -0.07         0.05   0.20
## POUTOU          -0.07   -0.13         0.06   0.17
## ROUSSEL         -0.26   -0.27         0.09   0.03
## MELENCHON       -0.54   -0.53        -0.29  -0.40
## JADOT            0.06    0.10        -0.07  -0.54
## HIDALGO         -0.11   -0.14        -0.11  -0.31
## LASSALLE         0.08    0.14         0.16   0.31
## MACRON           0.25    0.25        -0.16  -0.68
## PECRESSE         1.00    0.32        -0.02  -0.03
## ZEMMOUR          0.32    1.00        -0.01  -0.03
## DUPONTAIGNAN    -0.02   -0.01         1.00   0.29
## MLEPEN          -0.03   -0.03         0.29   1.00
\end{verbatim}

Le package corrplot permet de visualiser cette matrice de corrélation de façon plus intuitive:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(}\StringTok{"corrplot"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## corrplot 0.94 loaded
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{corrplot}\NormalTok{(cor.mat, }\AttributeTok{tl.col=}\StringTok{"black"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{manuel_geo_quanti_files/figure-latex/unnamed-chunk-54-1.pdf}

On peut exporter le résultat avec la fonction png de la façon suivante:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#png(file="TP09/matrice\_correlation.png", width = 1000, height = 1000)}
\FunctionTok{corrplot}\NormalTok{(cor.mat, }\AttributeTok{tl.col=}\StringTok{"black"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{manuel_geo_quanti_files/figure-latex/unnamed-chunk-55-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#dev.off()}
\end{Highlighting}
\end{Shaded}

On voit entre autres des corrélations :

\begin{itemize}
\item
  positives entre :

  \begin{itemize}
  \item
    le vote pour Hidalgo, Jadot et Macron,
  \item
    le vote Pécresse, Zemmour et Macron
  \end{itemize}
\item
  négative entre:

  \begin{itemize}
  \item
    le vote Marine Le Pen et le vote Jadot-Macron
  \item
    le vote Mélanchon et le vote Pecresse-Zemmour
  \end{itemize}
\end{itemize}

Très peu de corrélation entre les vote Zemmour et Marine Lepene.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{rm}\NormalTok{(cor.mat)}
\end{Highlighting}
\end{Shaded}

\hypertarget{ruxe9aliser-lacp}{%
\section{Réaliser l'ACP}\label{ruxe9aliser-lacp}}

\hypertarget{une-acp-non-ponduxe9ruxe9e}{%
\subsection{Une ACP non pondérée}\label{une-acp-non-ponduxe9ruxe9e}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{pca}\OtherTok{\textless{}{-}}\FunctionTok{PCA}\NormalTok{(data[,}\DecValTok{20}\SpecialCharTok{:}\DecValTok{31}\NormalTok{], }\AttributeTok{graph=}\NormalTok{T, }\AttributeTok{ncp =} \ConstantTok{NULL}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{manuel_geo_quanti_files/figure-latex/unnamed-chunk-57-1.pdf} \includegraphics{manuel_geo_quanti_files/figure-latex/unnamed-chunk-57-2.pdf}

L'objet pca est une liste dans lequel se trouve tous les résultats de l'ACP. On peut y accéder directement ou utiliser des fonctions préfaites pour visualiser les résultats:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# name               description}
\CommentTok{\# 1  "$eig"             "eigenvalues"}
\CommentTok{\# 2  "$var"             "results for the variables"}
\CommentTok{\# 3  "$var$coord"       "coord. for the variables"}
\CommentTok{\# 4  "$var$cor"         "correlations variables {-} dimensions"}
\CommentTok{\# 5  "$var$cos2"        "cos2 for the variables"}
\CommentTok{\# 6  "$var$contrib"     "contributions of the variables"}
\CommentTok{\# 7  "$ind"             "results for the individuals"}
\CommentTok{\# 8  "$ind$coord"       "coord. for the individuals"}
\CommentTok{\# 9  "$ind$cos2"        "cos2 for the individuals"}
\CommentTok{\# 10 "$ind$contrib"     "contributions of the individuals"}
\CommentTok{\# 11 "$call"            "summary statistics"}
\CommentTok{\# 12 "$call$centre"     "mean of the variables"}
\CommentTok{\# 13 "$call$ecart.type" "standard error of the variables"}
\CommentTok{\# 14 "$call$row.w"      "weights for the individuals"}
\CommentTok{\# 15 "$call$col.w"      "weights for the variables"}
\end{Highlighting}
\end{Shaded}

\hypertarget{ponduxe9rer-le-calcul-de-lacp}{%
\subsection{Pondérer le calcul de l'ACP}\label{ponduxe9rer-le-calcul-de-lacp}}

Dans le cas précédent chacuns des individus à le même poid et chaque variable également. On peut décider de modifier les poids.

Pourtant, il existe de grandes différences entre communes:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# mf\_export(x = communes\_voix ,}
\CommentTok{\#           filename =paste0("TP09/cartes\_votes\_exprimes.png" ),}
\CommentTok{\#           width = 900)}
\FunctionTok{mf\_map}\NormalTok{(}\AttributeTok{x =}\NormalTok{ communes\_voix, }\AttributeTok{col =} \ConstantTok{NA}\NormalTok{, }\AttributeTok{border =} \StringTok{"gray25"}\NormalTok{, }\AttributeTok{lwd =} \FloatTok{0.1}\NormalTok{)}
\FunctionTok{mf\_map}\NormalTok{(}\AttributeTok{x =}\NormalTok{ departements\_Paris, }\AttributeTok{col =} \ConstantTok{NA}\NormalTok{, }\AttributeTok{border =} \StringTok{"gray25"}\NormalTok{, }\AttributeTok{lwd =} \DecValTok{1}\NormalTok{, }\AttributeTok{add=}\NormalTok{T)}
\FunctionTok{mf\_map}\NormalTok{(communes\_voix ,}
       \AttributeTok{var=} \StringTok{"exprimes"}\NormalTok{,}
       \AttributeTok{type=}\StringTok{"prop"}\NormalTok{,}
       \AttributeTok{inches=}\FloatTok{0.1}\NormalTok{,}
       \AttributeTok{add=}\NormalTok{T)}
\end{Highlighting}
\end{Shaded}

\includegraphics{manuel_geo_quanti_files/figure-latex/unnamed-chunk-59-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#dev.off()}
\FunctionTok{rm}\NormalTok{(communes\_voix)}
\end{Highlighting}
\end{Shaded}

Si on souhaite pondérer les entités on peut utiliser ``row.w ='':

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{pca}\OtherTok{\textless{}{-}}\FunctionTok{PCA}\NormalTok{(data[,}\DecValTok{20}\SpecialCharTok{:}\DecValTok{31}\NormalTok{], }\AttributeTok{row.w =}\NormalTok{data}\SpecialCharTok{$}\NormalTok{exprimes,}\AttributeTok{ncp =} \ConstantTok{NULL}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{manuel_geo_quanti_files/figure-latex/unnamed-chunk-60-1.pdf} \includegraphics{manuel_geo_quanti_files/figure-latex/unnamed-chunk-60-2.pdf}

Pour pondérer les variables on peut utiliser col.w Attention: pour pondérer, il faut que tous les poids soient \textgreater0. Dans le cas présent ça ne pose pas de problème.

\hypertarget{visualiser-les-ruxe9sultats}{%
\section{Visualiser les résultats}\label{visualiser-les-ruxe9sultats}}

\hypertarget{cercles-de-corruxe9lation}{%
\subsection{Cercles de corrélation}\label{cercles-de-corruxe9lation}}

Ce résultat sont stocker dans l'objet pca:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{pca}\SpecialCharTok{$}\NormalTok{var}\SpecialCharTok{$}\NormalTok{coord}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##                    Dim.1        Dim.2        Dim.3       Dim.4       Dim.5
## ARTHAUD       0.75783970  0.193700662  0.053886556 -0.33202051  0.22476966
## POUTOU        0.70415312  0.004765184  0.418058777 -0.07460159  0.23692366
## ROUSSEL       0.66687033 -0.124984377  0.299327347  0.62640195  0.14923271
## MELENCHON     0.74370403 -0.538863968 -0.340415783 -0.02007377 -0.09595007
## JADOT        -0.45229731 -0.533488252  0.663311687 -0.03924331 -0.01890221
## HIDALGO      -0.10246245 -0.687312206  0.620349032 -0.17878940 -0.04634065
## LASSALLE      0.07686699  0.764044366  0.449976355 -0.03134172  0.14026444
## MACRON       -0.94011924 -0.048504652  0.166318959  0.02380460  0.02352660
## PECRESSE     -0.88585300  0.321419606 -0.009943942  0.04293183  0.14109764
## ZEMMOUR      -0.79129943  0.372205374 -0.100007056  0.06375980  0.19413646
## DUPONTAIGNAN  0.19419953  0.681063286  0.357058840  0.04326915 -0.55375208
## MLEPEN        0.45088539  0.809295495  0.102917819 -0.06620236  0.04182531
##                     Dim.6       Dim.7       Dim.8         Dim.9       Dim.10
## ARTHAUD      -0.270976655  0.38461093 -0.05343325 -0.0045179775 -0.008370156
## POUTOU        0.499863557  0.02458871 -0.12931404 -0.0007009491  0.015475982
## ROUSSEL      -0.131302409  0.12543543  0.02976306 -0.0269964797  0.028203308
## MELENCHON     0.007735581 -0.03917968 -0.02553644  0.1644913917  0.010914950
## JADOT        -0.069747306  0.01101491 -0.04680005 -0.0019169799 -0.225853682
## HIDALGO      -0.040984394 -0.01196939  0.24982650  0.0054539159  0.183340122
## LASSALLE     -0.191952534 -0.29553028 -0.08181916  0.2339225539  0.025984130
## MACRON       -0.043682377  0.04938810 -0.18414230 -0.1216818436  0.031798367
## PECRESSE      0.017812438  0.11278338 -0.11425240 -0.0094676328  0.152069481
## ZEMMOUR       0.158100636  0.20993077  0.27169444  0.1793777244 -0.079291052
## DUPONTAIGNAN  0.082126654  0.22599626 -0.03151295  0.0577028315  0.017115750
## MLEPEN       -0.004296971 -0.15138365  0.19561196 -0.2456237780 -0.040599884
##                     Dim.11       Dim.12
## ARTHAUD      -0.0140271624 3.282270e-10
## POUTOU       -0.0156209607 3.891439e-10
## ROUSSEL      -0.0056358853 1.336890e-09
## MELENCHON     0.0401760796 2.360485e-08
## JADOT         0.1036719950 3.831603e-09
## HIDALGO      -0.0166654983 1.030643e-09
## LASSALLE     -0.0303200827 9.593980e-10
## MACRON       -0.1759761971 1.521580e-08
## PECRESSE      0.2019841257 5.393004e-09
## ZEMMOUR      -0.0469535055 5.553946e-09
## DUPONTAIGNAN  0.0000869299 1.563518e-09
## MLEPEN        0.0428961375 1.323804e-08
\end{verbatim}

Les cercle de corrélation permettent de visualiser entre les variables et les dimensions produites par l'ACP.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{cercle\_1\_2}\OtherTok{\textless{}{-}}\FunctionTok{fviz\_pca\_var}\NormalTok{(pca,  }\AttributeTok{axes =} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{))}\SpecialCharTok{+}
  \FunctionTok{theme\_minimal}\NormalTok{()}
\NormalTok{cercle\_1\_2}
\end{Highlighting}
\end{Shaded}

\includegraphics{manuel_geo_quanti_files/figure-latex/unnamed-chunk-62-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#ggsave(cercle\_1\_2,filename="TP09/cercle\_correlation\_1\_2.png", width=7, height=7, bg="white")}
\CommentTok{\#rm(cercle\_1\_2)}
\end{Highlighting}
\end{Shaded}

On peut décider de visualiser d'autres axes en modifiant le paramètre axes:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{cercle\_1\_3}\OtherTok{\textless{}{-}}\FunctionTok{fviz\_pca\_var}\NormalTok{(pca,  }\AttributeTok{axes =} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{3}\NormalTok{))}\SpecialCharTok{+}
  \FunctionTok{theme\_minimal}\NormalTok{()}
\NormalTok{cercle\_1\_3}
\end{Highlighting}
\end{Shaded}

\includegraphics{manuel_geo_quanti_files/figure-latex/unnamed-chunk-63-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#ggsave(cercle\_1\_3,filename="TP09/cercle\_correlation\_1\_3.png", width=7, height=7, bg="white")}
\CommentTok{\#rm(cercle\_1\_3)}
\end{Highlighting}
\end{Shaded}

Pour faciliter la lecture, on peut inverser un axe en multipliant par -1 (dans notre cas, il est plus intuitif d'avoir la gauche politique à gauche et la droite à droite):

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{pca}\SpecialCharTok{$}\NormalTok{var}\SpecialCharTok{$}\NormalTok{coord[,}\DecValTok{1}\NormalTok{]}\OtherTok{\textless{}{-}} \SpecialCharTok{{-}}\DecValTok{1}\SpecialCharTok{*}\NormalTok{pca}\SpecialCharTok{$}\NormalTok{var}\SpecialCharTok{$}\NormalTok{coord[,}\DecValTok{1}\NormalTok{]}

\NormalTok{cercle\_1\_2}\OtherTok{\textless{}{-}}\FunctionTok{fviz\_pca\_var}\NormalTok{(pca,  }\AttributeTok{axes =} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{) )}\SpecialCharTok{+}
  \FunctionTok{theme\_minimal}\NormalTok{()}
\NormalTok{cercle\_1\_2}
\end{Highlighting}
\end{Shaded}

\includegraphics{manuel_geo_quanti_files/figure-latex/unnamed-chunk-64-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#ggsave(cercle\_1\_2,filename="TP09/cercle\_correlation\_1\_2.png", width=7, height=7, bg="white")}
\end{Highlighting}
\end{Shaded}

Il faut alors aussi le faire sur les coordonnées des individus:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{pca}\SpecialCharTok{$}\NormalTok{ind}\SpecialCharTok{$}\NormalTok{coord[,}\DecValTok{1}\NormalTok{]}\OtherTok{\textless{}{-}} \SpecialCharTok{{-}}\DecValTok{1}\SpecialCharTok{*}\NormalTok{ pca}\SpecialCharTok{$}\NormalTok{ind}\SpecialCharTok{$}\NormalTok{coord[,}\DecValTok{1}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

On peut décider de ne pas afficher toutes les variables (si il y en a trop ça devient illisible). Ici, on décide d'afficher surtout (en modifiant la tranparance) celles qui ont le plus contribué à la construction de les deux axes (alpha.var=``contrib'') ou celle qui sont le plus prise en compte par les deux axes (alpha.var=``cos2''), soit encore de sélectionner celles qui ont un cos2 supérieur à un seuil (select.var = list(cos2 = 0.75) ) ou les 3 qui contribuent le plus (select.var = list(contrib = 3))):

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{fviz\_pca\_var}\NormalTok{(pca,  }\AttributeTok{axes =} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{), }\AttributeTok{alpha.var=}\StringTok{"contrib"}\NormalTok{)}\SpecialCharTok{+}\FunctionTok{theme\_minimal}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics{manuel_geo_quanti_files/figure-latex/unnamed-chunk-66-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{fviz\_pca\_var}\NormalTok{(pca,  }\AttributeTok{axes =} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{), }\AttributeTok{alpha.var=}\StringTok{"cos2"}\NormalTok{)}\SpecialCharTok{+} \FunctionTok{theme\_minimal}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics{manuel_geo_quanti_files/figure-latex/unnamed-chunk-66-2.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{fviz\_pca\_var}\NormalTok{(pca,  }\AttributeTok{axes =} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{), }\AttributeTok{select.var =} \FunctionTok{list}\NormalTok{(}\AttributeTok{cos2 =} \FloatTok{0.75}\NormalTok{))}\SpecialCharTok{+} \FunctionTok{theme\_minimal}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics{manuel_geo_quanti_files/figure-latex/unnamed-chunk-66-3.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{fviz\_pca\_var}\NormalTok{(pca,  }\AttributeTok{axes =} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{), }\AttributeTok{select.var =} \FunctionTok{list}\NormalTok{(}\AttributeTok{contrib =} \DecValTok{3}\NormalTok{))}\SpecialCharTok{+} \FunctionTok{theme\_minimal}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics{manuel_geo_quanti_files/figure-latex/unnamed-chunk-66-4.pdf}

Il est peut aussi être pertinent d'utiliser l'argument repel=T pour utiliser le package repel pour les étiquettes et éviter qu'elle ne se chevauches:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{fviz\_pca\_var}\NormalTok{(pca,  }\AttributeTok{axes =} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{), }\AttributeTok{repel=}\NormalTok{T )}\SpecialCharTok{+}  \FunctionTok{theme\_minimal}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics{manuel_geo_quanti_files/figure-latex/unnamed-chunk-67-1.pdf}

\hypertarget{contributions-de-chaque-variables}{%
\subsection{Contributions de chaque variables}\label{contributions-de-chaque-variables}}

La contribution de chaque variable à la construction de chacune de dimension:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{pca}\SpecialCharTok{$}\NormalTok{var}\SpecialCharTok{$}\NormalTok{contrib}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##                   Dim.1        Dim.2        Dim.3       Dim.4       Dim.5
## ARTHAUD      11.9038406 1.231246e+00  0.183052896 19.83392132  9.58930308
## POUTOU       10.2770061 7.451467e-04 11.017687192  1.00132471 10.65438844
## ROUSSEL       9.2175433 5.126181e-01  5.648180142 70.59679126  4.22707266
## MELENCHON    11.4639072 9.528856e+00  7.305250657  0.07249975  1.74743980
## JADOT         4.2401420 9.339684e+00 27.736460944  0.27708309  0.06781672
## HIDALGO       0.2176015 1.550210e+01 24.259841866  5.75125091  0.40760167
## LASSALLE      0.1224650 1.915665e+01 12.764245064  0.17673574  3.73427942
## MACRON       18.3188531 7.720568e-02  1.743810408  0.10195308  0.10505823
## PECRESSE     16.2650617 3.390215e+00  0.006233513  0.33161753  3.77877609
## ZEMMOUR      12.9781893 4.546192e+00  0.630488306  0.73142974  7.15362007
## DUPONTAIGNAN  0.7816796 1.522150e+01  8.037025154  0.33684917 58.20260409
## MLEPEN        4.2137107 2.149298e+01  0.667723858  0.78854370  0.33203971
##                     Dim.6       Dim.7      Dim.8        Dim.9      Dim.10
## ARTHAUD      17.567987257 38.26088046  1.1309610 1.056017e-02  0.05892929
## POUTOU       59.780728472  0.15638066  6.6239329 2.541885e-04  0.20145614
## ROUSSEL       4.124807104  4.06960429  0.3508970 3.770484e-01  0.66905864
## MELENCHON     0.014316739  0.39703930  0.2583124 1.399810e+01  0.10020919
## JADOT         1.163893177  0.03138149  0.8675954 1.901157e-03 42.90604037
## HIDALGO       0.401878970  0.03705574 24.7230208 1.538862e-02 28.27347030
## LASSALLE      8.815479728 22.58997116  2.6517620 2.830917e+01  0.56791122
## MACRON        0.456531526  0.63089386 13.4317208 7.660100e+00  0.85049882
## PECRESSE      0.075911050  3.29004564  5.1707694 4.637305e-02 19.45128139
## ZEMMOUR       5.980334606 11.39892589 29.2405834 1.664638e+01  5.28825575
## DUPONTAIGNAN  1.613713804 13.21034744  0.3933712 1.722571e+00  0.24640866
## MLEPEN        0.004417566  5.92747407 15.1570737 3.121215e+01  1.38648022
##                    Dim.11      Dim.12
## ARTHAUD      2.190093e-01  0.01030897
## POUTOU       2.716054e-01  0.01449063
## ROUSSEL      3.535471e-02  0.17102445
## MELENCHON    1.796628e+00 53.31743705
## JADOT        1.196316e+01  1.40484268
## HIDALGO      3.091431e-01  0.10164445
## LASSALLE     1.023255e+00  0.08807739
## MACRON       3.446917e+01 22.15420622
## PECRESSE     4.541062e+01  2.78309654
## ZEMMOUR      2.453912e+00  2.95168558
## DUPONTAIGNAN 8.411265e-06  0.23392274
## MLEPEN       2.048139e+00 16.76926331
\end{verbatim}

On peut également afficher de façon graphique avec fviz\_contrib:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{fviz\_contrib}\NormalTok{(pca, }\AttributeTok{choice =} \StringTok{"var"}\NormalTok{, }\AttributeTok{axes =} \DecValTok{1}\NormalTok{, }\AttributeTok{top =} \DecValTok{10}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{manuel_geo_quanti_files/figure-latex/unnamed-chunk-69-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{fviz\_contrib}\NormalTok{(pca, }\AttributeTok{choice =} \StringTok{"var"}\NormalTok{, }\AttributeTok{axes =} \DecValTok{2}\NormalTok{, }\AttributeTok{top =} \DecValTok{10}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{manuel_geo_quanti_files/figure-latex/unnamed-chunk-69-2.pdf}

\hypertarget{valeurs-propres-et-de-la-variance-expliquuxe9e}{%
\subsection{Valeurs propres et \% de la variance expliquée}\label{valeurs-propres-et-de-la-variance-expliquuxe9e}}

Pour afficher les valeurs propres (eigen value) et le pourcentage de variance expliquée, on peut simplement afficher le tableau compris dans l'objet pca

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{pca}\SpecialCharTok{$}\NormalTok{eig}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##           eigenvalue percentage of variance cumulative percentage of variance
## comp 1  4.824670e+00           4.020558e+01                          40.20558
## comp 2  3.047316e+00           2.539430e+01                          65.59988
## comp 3  1.586296e+00           1.321913e+01                          78.81902
## comp 4  5.558034e-01           4.631695e+00                          83.45071
## comp 5  5.268516e-01           4.390430e+00                          87.84114
## comp 6  4.179668e-01           3.483056e+00                          91.32420
## comp 7  3.866235e-01           3.221863e+00                          94.54606
## comp 8  2.524500e-01           2.103750e+00                          96.64981
## comp 9  1.932934e-01           1.610779e+00                          98.26059
## comp 10 1.188874e-01           9.907285e-01                          99.25132
## comp 11 8.984151e-02           7.486793e-01                         100.00000
## comp 12 1.045041e-15           8.708673e-15                         100.00000
\end{verbatim}

On peut faire un graphique de la variance expliquées:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{fviz\_screeplot}\NormalTok{(pca, }\AttributeTok{ncp=}\DecValTok{10}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{manuel_geo_quanti_files/figure-latex/unnamed-chunk-71-1.pdf}

Ces informations sont utiles pour nous aider à décider combien de composante retenir. Généralement, on s'arrange avec ces règles non-strictes: - eigenvalue \textgreater{} 1 - variance cumulée \textgreater{} 70\% - gain faible d'une composante supplémentaire (ajouter une dimension supplémentaire ne permet pas de gagner beaucoup en variance expliquée)

\hypertarget{carte-de-scores}{%
\subsection{Carte de scores}\label{carte-de-scores}}

Chaque individus est reprojeter sur les nouvelles dimensions. Leurs scores sont stocké dans l'objet pca:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{head}\NormalTok{(pca}\SpecialCharTok{$}\NormalTok{ind}\SpecialCharTok{$}\NormalTok{coord)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      Dim.1      Dim.2       Dim.3        Dim.4       Dim.5      Dim.6
## 1 3.067555 -1.7114152  0.08150264 -0.185735850 -0.41247012 -0.1498315
## 2 2.511828 -2.7064534  0.70245008 -0.193923389 -0.70891924 -0.4567220
## 3 2.031107 -3.0966114  1.07311078 -0.404287195 -0.18691460 -0.5270521
## 4 2.201343 -2.4124210  1.18680228 -0.001301227 -0.20907736  0.2881203
## 5 1.991101 -2.2577563  1.02941720 -0.014047196 -0.02204558 -0.1995434
## 6 3.955340 -0.8826657 -0.20675170  0.106337247  0.01854102 -0.1812643
##         Dim.7       Dim.8      Dim.9      Dim.10      Dim.11        Dim.12
## 1 -0.31386218  0.51897558 -0.4392267  0.16799431 -0.45550607 -2.122990e-09
## 2 -0.53505432  0.36256495 -0.6205415 -0.13143940 -0.64944655 -2.768542e-09
## 3 -0.32566793  0.04083631 -0.7457277 -0.17322620 -0.51307636 -6.765777e-09
## 4 -0.18494092  0.55795434 -0.3835738  0.18158093 -0.51829968 -1.631543e-09
## 5 -0.07027549  0.24404548 -0.1594431  0.07828135 -0.03678451 -1.845831e-09
## 6  0.07415939 -0.23014907 -0.3167121  0.16569411 -0.35174294 -2.268829e-09
\end{verbatim}

On peut souhaiter les visualiser dans un graphique à deux dimensions:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{fviz\_pca\_ind}\NormalTok{(pca)}
\end{Highlighting}
\end{Shaded}

\includegraphics{manuel_geo_quanti_files/figure-latex/unnamed-chunk-73-1.pdf}

Forcément cela à du sens que si on a peu d'individus. Si les individus sont des entités géographiques, on peut souhaiter en faire des cartes.

On peut récupérer les score de chaque individus en collant avec bind\_rows les coordonnées avec le set de données initiale. On doit utiliser ici bind\_rows plutôt qu'une jointure (left\_join, right\_join) parce que l'agorythme de FactoMineR ne conserve pas d'ID lors de la réalisation de l'ACP mais il conserve bien l'ordre des lignes mise en entrée:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{data\_pca}\OtherTok{\textless{}{-}}\FunctionTok{bind\_cols}\NormalTok{(data,}
\NormalTok{                    pca}\SpecialCharTok{$}\NormalTok{ind}\SpecialCharTok{$}\NormalTok{coord)}
\end{Highlighting}
\end{Shaded}

On réalise une boucle pour visualiser les 3 premières dimensions en faisant d'abord la jointure entre nos résultats et l'objet commune:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{communes\_pca}\OtherTok{\textless{}{-}}\NormalTok{communes }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{inner\_join}\NormalTok{(data\_pca, }\AttributeTok{by=}\FunctionTok{c}\NormalTok{(}\StringTok{"insee"}\OtherTok{=}\StringTok{"codecommune"}\NormalTok{))}


\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\DecValTok{3}\NormalTok{)\{}
  \CommentTok{\# mf\_export(x = communes\_pca ,}
  \CommentTok{\#           filename =paste0("TP09/carte\_acp\_dim",i,".png" ),}
  \CommentTok{\#           width = 900)}
  \FunctionTok{mf\_map}\NormalTok{(communes\_pca ,}
         \AttributeTok{var=} \FunctionTok{paste0}\NormalTok{(}\StringTok{"Dim."}\NormalTok{,i),}
         \AttributeTok{type=}\StringTok{"choro"}\NormalTok{,}
         \AttributeTok{pal=} \StringTok{"Viridis"}\NormalTok{,}
         \AttributeTok{lwd=}\FloatTok{0.001}\NormalTok{)}
  \FunctionTok{mf\_map}\NormalTok{(}\AttributeTok{x =}\NormalTok{ departements\_Paris, }\AttributeTok{col =} \ConstantTok{NA}\NormalTok{, }\AttributeTok{border =} \StringTok{"gray25"}\NormalTok{, }\AttributeTok{lwd =} \DecValTok{1}\NormalTok{, }\AttributeTok{add=}\NormalTok{T)}
  \CommentTok{\# dev.off()}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\includegraphics{manuel_geo_quanti_files/figure-latex/unnamed-chunk-75-1.pdf} \includegraphics{manuel_geo_quanti_files/figure-latex/unnamed-chunk-75-2.pdf} \includegraphics{manuel_geo_quanti_files/figure-latex/unnamed-chunk-75-3.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{rm}\NormalTok{(i,communes\_pca)}
\end{Highlighting}
\end{Shaded}

\hypertarget{ajouter-des-variables-suppluxe9mentaires}{%
\section{Ajouter des variables supplémentaires}\label{ajouter-des-variables-suppluxe9mentaires}}

Pour aider à l'interprétation des axes, il peut être utile d'importer des nouvelles variables qui ne seront pas utilisées dans l'ACP mais qu'on pourra néanmoins utiliser comme repère.

\hypertarget{importation-des-donnuxe9es-1}{%
\subsection{Importation des données}\label{importation-des-donnuxe9es-1}}

\hypertarget{population}{%
\subsubsection{Population}\label{population}}

On importe les données de population:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{pop}\OtherTok{\textless{}{-}}\FunctionTok{read\_excel}\NormalTok{(}\StringTok{"data/France/population\_insee\_2021.xlsx"}\NormalTok{, }\AttributeTok{sheet=}\StringTok{"Communes"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{codecommune=}\FunctionTok{paste0}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Code département}\StringTok{\textasciigrave{}}\NormalTok{, }\StringTok{\textasciigrave{}}\AttributeTok{Code commune}\StringTok{\textasciigrave{}}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Code région}\StringTok{\textasciigrave{}}\SpecialCharTok{==}\StringTok{"11"}\NormalTok{) }\CommentTok{\# on garde que la France métropolitaine}
\end{Highlighting}
\end{Shaded}

On joint avec le fichier spatial des communes et calcul la densité de population

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{communes\_pop}\OtherTok{\textless{}{-}}\NormalTok{ communes }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{left\_join}\NormalTok{(pop, }\AttributeTok{by=}\FunctionTok{c}\NormalTok{(}\StringTok{"insee"}\OtherTok{=}\StringTok{"codecommune"}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{densite\_ha=}\StringTok{\textasciigrave{}}\AttributeTok{Population totale}\StringTok{\textasciigrave{}}\SpecialCharTok{/}\NormalTok{surface) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(insee, densite\_ha)}
\end{Highlighting}
\end{Shaded}

On peut réaliser une carte de la densité de population

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# mf\_export(x = communes\_pop ,}
\CommentTok{\#           filename =paste0("TP09/carte\_densite.png" ),}
\CommentTok{\#           width = 900)}
\FunctionTok{mf\_map}\NormalTok{(communes\_pop ,}
       \AttributeTok{var=} \StringTok{"densite\_ha"}\NormalTok{,}
       \AttributeTok{type=}\StringTok{"choro"}\NormalTok{,}
       \AttributeTok{pal=} \StringTok{"Viridis"}\NormalTok{,}
       \AttributeTok{lwd=}\FloatTok{0.001}\NormalTok{)}
\FunctionTok{mf\_map}\NormalTok{(}\AttributeTok{x =}\NormalTok{ departements\_Paris, }\AttributeTok{col =} \ConstantTok{NA}\NormalTok{, }\AttributeTok{border =} \StringTok{"red"}\NormalTok{, }\AttributeTok{lwd =} \DecValTok{1}\NormalTok{, }\AttributeTok{add=}\NormalTok{T)}
\end{Highlighting}
\end{Shaded}

\includegraphics{manuel_geo_quanti_files/figure-latex/unnamed-chunk-78-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#dev.off()}
\end{Highlighting}
\end{Shaded}

On enlève transforme l'objet en dataframe et on enlève la colonne geom:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{communes\_pop\_df}\OtherTok{\textless{}{-}}\NormalTok{communes\_pop }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{as.data.frame}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{geom)}
\end{Highlighting}
\end{Shaded}

On réalise la jointure avec les données de base:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{data}\OtherTok{\textless{}{-}}\NormalTok{data }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{left\_join}\NormalTok{(communes\_pop\_df, }\AttributeTok{by=}\FunctionTok{c}\NormalTok{(}\StringTok{"codecommune"}\OtherTok{=}\StringTok{"insee"}\NormalTok{))}

\FunctionTok{rm}\NormalTok{(pop,communes\_pop, communes\_pop\_df)}
\end{Highlighting}
\end{Shaded}

\hypertarget{revenus}{%
\subsubsection{Revenus}\label{revenus}}

On importe les données de revenus, on conserve les champ qui nous intéresse et on transforme le champ revenu médian en ``numeric'':

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{revenus}\OtherTok{\textless{}{-}}\FunctionTok{read\_excel}\NormalTok{(}\StringTok{"data/France/FILO2021\_DEC\_COM.xlsx"}\NormalTok{, }\AttributeTok{sheet=}\DecValTok{2}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{revenus=}\FunctionTok{as.numeric}\NormalTok{(revenu\_median)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(CODGEO, revenus)}
\end{Highlighting}
\end{Shaded}

On joint avec le fichier spatial des communes et les revenus:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{communes\_revenus}\OtherTok{\textless{}{-}}\NormalTok{ communes }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{left\_join}\NormalTok{(revenus, }\AttributeTok{by=}\FunctionTok{c}\NormalTok{(}\StringTok{"insee"}\OtherTok{=}\StringTok{"CODGEO"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

On peut réaliser une carte de revenu:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# mf\_export(x = communes\_revenus ,}
\CommentTok{\#           filename =paste0("TP09/carte\_revenus.png" ),}
\CommentTok{\#           width = 900)}
\FunctionTok{mf\_map}\NormalTok{(communes\_revenus ,}
       \AttributeTok{var=} \StringTok{"revenus"}\NormalTok{,}
       \AttributeTok{type=}\StringTok{"choro"}\NormalTok{,}
       \AttributeTok{pal=} \StringTok{"Viridis"}\NormalTok{,}
       \AttributeTok{lwd=}\FloatTok{0.001}\NormalTok{)}
\FunctionTok{mf\_map}\NormalTok{(}\AttributeTok{x =}\NormalTok{ departements\_Paris, }\AttributeTok{col =} \ConstantTok{NA}\NormalTok{, }\AttributeTok{border =} \StringTok{"red"}\NormalTok{, }\AttributeTok{lwd =} \DecValTok{1}\NormalTok{, }\AttributeTok{add=}\NormalTok{T)}
\end{Highlighting}
\end{Shaded}

\includegraphics{manuel_geo_quanti_files/figure-latex/unnamed-chunk-83-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#dev.off()}

\FunctionTok{rm}\NormalTok{(communes\_revenus)}
\end{Highlighting}
\end{Shaded}

On réalise la jointure avec les données de base:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{data}\OtherTok{\textless{}{-}}\NormalTok{data }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{left\_join}\NormalTok{(revenus, }\AttributeTok{by=}\FunctionTok{c}\NormalTok{(}\StringTok{"codecommune"}\OtherTok{=}\StringTok{"CODGEO"}\NormalTok{))}
\FunctionTok{rm}\NormalTok{(revenus)}
\end{Highlighting}
\end{Shaded}

\hypertarget{acp-avec-les-variables-suppluxe9mentaires}{%
\subsection{ACP avec les variables supplémentaires}\label{acp-avec-les-variables-suppluxe9mentaires}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{pca}\OtherTok{\textless{}{-}}\FunctionTok{PCA}\NormalTok{(data[,}\DecValTok{20}\SpecialCharTok{:}\DecValTok{33}\NormalTok{], }\AttributeTok{quanti.sup =} \DecValTok{13}\SpecialCharTok{:}\DecValTok{14}\NormalTok{, }\AttributeTok{row.w =}\NormalTok{data}\SpecialCharTok{$}\NormalTok{exprimes, }\AttributeTok{graph=}\NormalTok{F, }\AttributeTok{ncp =} \ConstantTok{NULL}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning in PCA(data[, 20:33], quanti.sup = 13:14, row.w = data$exprimes, :
## Missing values are imputed by the mean of the variable: you should use the
## imputePCA function of the missMDA package
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{cercle\_1\_2}\OtherTok{\textless{}{-}}\FunctionTok{fviz\_pca\_var}\NormalTok{(pca,  }\AttributeTok{axes =} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{))}\SpecialCharTok{+}
  \FunctionTok{theme\_minimal}\NormalTok{()}
\NormalTok{cercle\_1\_2}
\end{Highlighting}
\end{Shaded}

\includegraphics{manuel_geo_quanti_files/figure-latex/unnamed-chunk-85-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#ggsave(cercle\_1\_2,filename="TP09/cercle\_correlation\_1\_2\_revenu\_pop.png", width=7, height=7, bg="white")}
\FunctionTok{rm}\NormalTok{(cercle\_1\_2)}


\NormalTok{cercle\_1\_3}\OtherTok{\textless{}{-}}\FunctionTok{fviz\_pca\_var}\NormalTok{(pca,  }\AttributeTok{axes =} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{3}\NormalTok{))}\SpecialCharTok{+}
  \FunctionTok{theme\_minimal}\NormalTok{()}
\NormalTok{cercle\_1\_3}
\end{Highlighting}
\end{Shaded}

\includegraphics{manuel_geo_quanti_files/figure-latex/unnamed-chunk-85-2.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#ggsave(cercle\_1\_3,filename="TP09/cercle\_correlation\_1\_3\_revenu\_pop.png", width=7, height=7, bg="white")}
\FunctionTok{rm}\NormalTok{(cercle\_1\_3)}
\end{Highlighting}
\end{Shaded}

On observe des fortes corrélations entre la première dimension qui dépeind une opposition gauche-droite et la variable de revenus, les revenus élevés étant associés aux communes où le vote de droite est important. La seconde dimension est quant à elle fortement corrélée à la densité de population et permet d'interprétée cette dernière comme l'opposition centre urbain-périphérie

\hypertarget{aller-plus-loin}{%
\section{Aller plus loin}\label{aller-plus-loin}}

Il est possible de faire des ACP sur des données d'enquêtes soit en utilisant les poids comme présenté précédement soit grâce au package :svyprcomp (\url{https://r-survey.r-forge.r-project.org/survey/html/svyprcomp.html})

On peut vouloir réaliser des légères rotations des axes pour améliorer la lecture des axes: \href{https://stats.stackexchange.com/questions/59213/how-to-compute-varimax-rotated-principal-components-in-r\%20https://dimension.usherbrooke.ca/pages/87}{https://stats.stackexchange.com/questions/59213/how-to-compute-varimax-rotated-principal-components-in-r https://dimension.usherbrooke.ca/pages/87}

\url{https://sites.google.com/site/rgraphiques/4--stat/machine-learning-biostatistiques-analyse-de-donn\%C3\%A9es/analyse-en-composantes-principales/la-rotation-varimax}

\hypertarget{ressources-utilisuxe9es}{%
\section{Ressources utilisées}\label{ressources-utilisuxe9es}}

\begin{itemize}
\item
  \url{http://www.sthda.com/english/wiki/wiki.php?id_contents=7851}
\item
  \url{http://factominer.free.fr/index_fr.html}
\end{itemize}

\hypertarget{classification}{%
\chapter{Classification}\label{classification}}

\hypertarget{objectifs-1}{%
\section{Objectifs}\label{objectifs-1}}

Ce tp a pour objectif de réaliser une classification ascendante hiérarchique des secteurs statistiques de Bruxelles en utilisant des variables de la structure de la propriété des logements mis en location.

\hypertarget{pruxe9paration-1}{%
\section{Préparation}\label{pruxe9paration-1}}

De façon maintenant habituelle:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyverse) }\CommentTok{\# Manipulation des données }
\FunctionTok{library}\NormalTok{(sf) }\CommentTok{\# Manipulation des données spatiales}
\FunctionTok{library}\NormalTok{(mapsf) }\CommentTok{\# Réalisation de carte}
\FunctionTok{library}\NormalTok{(readxl) }\CommentTok{\# Importation de données Excel}
\FunctionTok{library}\NormalTok{(kableExtra) }\CommentTok{\# Réalisation de tableau }
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Attachement du package : 'kableExtra'
\end{verbatim}

\begin{verbatim}
## L'objet suivant est masqué depuis 'package:huxtable':
## 
##     add_footnote
\end{verbatim}

\begin{verbatim}
## L'objet suivant est masqué depuis 'package:dplyr':
## 
##     group_rows
\end{verbatim}

Et deux packages développés pour réaliser des ACP et visualiser les résultats:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(FactoMineR)}
\FunctionTok{library}\NormalTok{(factoextra)}
\end{Highlighting}
\end{Shaded}

Pour ce TP, on utilisera également le packages JLutils:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#library(devtools)}
\CommentTok{\#devtools::install\_github("larmarange/JLutils")}
\FunctionTok{library}\NormalTok{(JLutils)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Registered S3 method overwritten by 'GGally':
##   method from   
##   +.gg   ggplot2
\end{verbatim}

\begin{verbatim}
## 
## Attachement du package : 'JLutils'
\end{verbatim}

\begin{verbatim}
## Les objets suivants sont masqués depuis 'package:ggstats':
## 
##     ggsurvey, signif_stars
\end{verbatim}

Pour cette classification, on utiliser des indicateurs construits à partir des données du cadastre (1 janvier 2015) utilisée dans ma thèse (\url{https://difusion.ulb.ac.be/vufind/Record/ULB-DIPOT:oai:dipot.ulb.ac.be:2013/359086/Holdings})

Les variables utilisées sont:

\begin{itemize}
\item
  cd\_sector = code secteur statistique
\item
  NB\_LOG = nombre de logements total
\item
  NB\_LOGLOUE\_TOT = nombre de logements loués total
\item
  NB\_LOCDOM = nombre de logements loués à domicile
\item
  prop\_occup = proportion de propriétaires occupants
\item
  prop\_LOCDOM = proportion de logements loués à domicile
\item
  prop\_LOC\_HBX = proportion de logements loués par des propriétaires habitants en dehors de la région de Bruxelles
\item
  dist\_200 = proportion de logements loués par des propriétaires domiciliés à moins de 200 m
\item
  cinq\_plus = proportion de logements loués possédés par des propriétaires possédants 5 logements ou plus à Bruxelles
\item
  vingt\_plus = proportion de logements loués possédés par des propriétaires possédants 20 logements ou plus à Bruxelles
\item
  log\_sociaux = proportion des logements sociaux parmi les logements loués
\item
  entrep\_sprl\_sa = proportion des logements possédés par des entreprises privées parmi les logements loués
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{cadastre }\OtherTok{\textless{}{-}} \FunctionTok{read\_delim}\NormalTok{( }\StringTok{"data/cadastre\_2015\_secteurs.csv"}\NormalTok{, }\AttributeTok{delim=}\StringTok{";"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(NB\_LOGLOUE\_TOT}\SpecialCharTok{\textgreater{}=}\DecValTok{200}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Rows: 724 Columns: 12
## -- Column specification --------------------------------------------------------
## Delimiter: ";"
## chr  (1): cd_sector
## dbl (11): NB_LOG, NB_LOGLOUE_TOT, NB_LOCDOM, prop_occup, prop_LOCDOM, prop_L...
## 
## i Use `spec()` to retrieve the full column specification for this data.
## i Specify the column types or set `show_col_types = FALSE` to quiet this message.
\end{verbatim}

\hypertarget{acp}{%
\section{ACP}\label{acp}}

Pour réaliser la classification, on va d'abord réaliser une classification. Cela nous permet d'éliminer le bruit.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{pca}\OtherTok{\textless{}{-}}\FunctionTok{PCA}\NormalTok{(cadastre[,}\DecValTok{6}\SpecialCharTok{:}\DecValTok{12}\NormalTok{], }\AttributeTok{row.w =}\NormalTok{cadastre}\SpecialCharTok{$}\NormalTok{NB\_LOGLOUE\_TOT,}\AttributeTok{ncp =} \ConstantTok{NULL}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{manuel_geo_quanti_files/figure-latex/unnamed-chunk-90-1.pdf} \includegraphics{manuel_geo_quanti_files/figure-latex/unnamed-chunk-90-2.pdf}

On se demande combien de composante garder: les 3 premières représentes 80\% de la variance.

\begin{verbatim}
fviz_screeplot(pca, ncp=10)
pca$eig
\end{verbatim}

On peut joindre les socres des ACP aux données

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{cadastre}\OtherTok{\textless{}{-}}\FunctionTok{bind\_cols}\NormalTok{(cadastre,pca}\SpecialCharTok{$}\NormalTok{ind}\SpecialCharTok{$}\NormalTok{coord)}
\end{Highlighting}
\end{Shaded}

\hypertarget{classification-ascendente-hiuxe9rarchique}{%
\section{Classification ascendente hiérarchique}\label{classification-ascendente-hiuxe9rarchique}}

\hypertarget{calcul-de-la-classification}{%
\subsection{Calcul de la classification}\label{calcul-de-la-classification}}

On extrait les scores des trois premières composantes qu'on va utiliser dans la classification:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{score}\OtherTok{\textless{}{-}}\NormalTok{pca}\SpecialCharTok{$}\NormalTok{ind}\SpecialCharTok{$}\NormalTok{coord[,}\DecValTok{1}\SpecialCharTok{:}\DecValTok{3}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

On calcul une matrice de distance euclidienne:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{dist }\OtherTok{\textless{}{-}} \FunctionTok{dist}\NormalTok{(score, }\AttributeTok{method =} \StringTok{"euclidean"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

On réalise la classification avec la méthode de Ward:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{hcpc }\OtherTok{\textless{}{-}} \FunctionTok{hclust}\NormalTok{(dist, }\AttributeTok{method =} \StringTok{"ward.D"}\NormalTok{ )}
\end{Highlighting}
\end{Shaded}

\hypertarget{choix-du-nombre-de-classe}{%
\subsection{Choix du nombre de classe}\label{choix-du-nombre-de-classe}}

On peut réaliser le dendogramme :

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot}\NormalTok{(hcpc, }\AttributeTok{cex =} \FloatTok{0.6}\NormalTok{, }\AttributeTok{hang =} \SpecialCharTok{{-}}\DecValTok{1}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{manuel_geo_quanti_files/figure-latex/unnamed-chunk-95-1.pdf}

Ainsi que le graphique d'inertie:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{inertie }\OtherTok{\textless{}{-}} \FunctionTok{sort}\NormalTok{(hcpc}\SpecialCharTok{$}\NormalTok{height, }\AttributeTok{decreasing =} \ConstantTok{TRUE}\NormalTok{)}
\FunctionTok{plot}\NormalTok{(inertie[}\DecValTok{1}\SpecialCharTok{:}\DecValTok{20}\NormalTok{], }\AttributeTok{type =} \StringTok{"s"}\NormalTok{, }\AttributeTok{xlab =} \StringTok{"Nombre de classes"}\NormalTok{, }\AttributeTok{ylab =} \StringTok{"Inertie"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{manuel_geo_quanti_files/figure-latex/unnamed-chunk-96-1.pdf}

Il apparaît ici que le gain pour ajouter une classe supplémentaire diminue fortement après la 5ème classe

On définit donc le paramètre k=5:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#png(filename = "TP10/dendogramme.png")}
\FunctionTok{plot}\NormalTok{(hcpc, }\AttributeTok{cex =} \FloatTok{0.6}\NormalTok{, }\AttributeTok{hang =} \SpecialCharTok{{-}}\DecValTok{1}\NormalTok{)}
\FunctionTok{rect.hclust}\NormalTok{(hcpc , }\AttributeTok{k =} \DecValTok{5}\NormalTok{, }\AttributeTok{border =} \DecValTok{2}\SpecialCharTok{:}\DecValTok{6}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{manuel_geo_quanti_files/figure-latex/unnamed-chunk-97-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#dev.off()}
\end{Highlighting}
\end{Shaded}

Il existe une fonction de JLutils qui permet de claculer le nombre de classes ``optimale''.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{best.cutree}\NormalTok{(hcpc)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 4
\end{verbatim}

\hypertarget{visualisation-des-ruxe9sultats}{%
\section{Visualisation des résultats}\label{visualisation-des-ruxe9sultats}}

\hypertarget{extraire-les-groupes}{%
\subsection{Extraire les groupes}\label{extraire-les-groupes}}

On peut alors associer chaque individus (ici les secteurs statistiques) à chaque un groupe:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{hcpc\_indiv }\OtherTok{\textless{}{-}} \FunctionTok{cutree}\NormalTok{(hcpc, }\AttributeTok{k =} \DecValTok{5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

On peut alors rapatrier les résultats sur les données de bases:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{cadastre}\OtherTok{\textless{}{-}}\NormalTok{cadastre }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{clust=} \FunctionTok{as.factor}\NormalTok{(hcpc\_indiv))}
\end{Highlighting}
\end{Shaded}

\hypertarget{un-graphique-selon-les-groupes}{%
\subsection{Un graphique selon les groupes}\label{un-graphique-selon-les-groupes}}

On peut réaliser un graphique où on place chaque individus (ici les secteurs statistiques) sur les deux dimensions construites lors de l'ACP et on colorie les points selon la classe:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(}\AttributeTok{data=}\NormalTok{cadastre,}
       \FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\NormalTok{Dim}\FloatTok{.1}\NormalTok{, }\AttributeTok{y=}\NormalTok{Dim}\FloatTok{.2}\NormalTok{, }\AttributeTok{color=}\NormalTok{clust)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{()}\SpecialCharTok{+}
  \FunctionTok{theme\_minimal}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics{manuel_geo_quanti_files/figure-latex/unnamed-chunk-101-1.pdf}

\hypertarget{une-carte-des-groupes}{%
\subsection{Une carte des groupes}\label{une-carte-des-groupes}}

On importe les secteurs statistiques et garde que les secteurs bruxellois:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{secteurs\_stats}\OtherTok{\textless{}{-}} \FunctionTok{st\_read}\NormalTok{ (}\StringTok{"data/sh\_statbel\_statistical\_sectors\_31370\_20230101.gpkg"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(tx\_rgn\_descr\_fr}\SpecialCharTok{==}\StringTok{"Région de Bruxelles{-}Capitale"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Reading layer `secteurs_stats2023' from data source 
##   `C:\Users\hugop\Nextcloud\git\manuel_geo_quanti\data\sh_statbel_statistical_sectors_31370_20230101.gpkg' 
##   using driver `GPKG'
## Simple feature collection with 19795 features and 31 fields
## Geometry type: MULTIPOLYGON
## Dimension:     XY
## Bounding box:  xmin: 21991.63 ymin: 21162.16 xmax: 295167.1 ymax: 244027.2
## Projected CRS: BD72 / Belgian Lambert 72
\end{verbatim}

On construit un objet spatial communes pour la cartographie:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{communes}\OtherTok{\textless{}{-}}\NormalTok{secteurs\_stats }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(tx\_munty\_descr\_fr) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{geom=}\FunctionTok{st\_union}\NormalTok{(geom))}
\end{Highlighting}
\end{Shaded}

On joint les groupes aux secteurs statistiques:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{secteurs\_stats\_cad}\OtherTok{\textless{}{-}}\NormalTok{ secteurs\_stats  }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{left\_join}\NormalTok{(cadastre, }\AttributeTok{by=}\StringTok{"cd\_sector"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

On réalise la carte:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# On peut aussi définir une palette de couleur pour facilité la lecture}
\NormalTok{pal }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"red"}\NormalTok{, }\StringTok{"blue"}\NormalTok{, }\StringTok{"purple"}\NormalTok{, }\StringTok{"green"}\NormalTok{, }\StringTok{"orange"}\NormalTok{)}

\CommentTok{\# mf\_export(x = secteurs\_stats\_cad ,}
\CommentTok{\#           filename =paste0("TP10\_typo/carte\_typo.png" ),}
\CommentTok{\#           width = 900)}
\FunctionTok{mf\_map}\NormalTok{(}\AttributeTok{x =}\NormalTok{ secteurs\_stats, }\AttributeTok{col =} \ConstantTok{NA}\NormalTok{, }\AttributeTok{border =} \StringTok{"gray25"}\NormalTok{, }\AttributeTok{lwd =} \FloatTok{0.3}\NormalTok{)}
\FunctionTok{mf\_map}\NormalTok{(secteurs\_stats\_cad ,}
       \AttributeTok{var=} \FunctionTok{c}\NormalTok{(}\StringTok{"NB\_LOGLOUE\_TOT"}\NormalTok{,}\StringTok{"clust"}\NormalTok{),}
       \AttributeTok{type=}\StringTok{"prop\_typo"}\NormalTok{,}
       \AttributeTok{inches =} \FloatTok{0.08}\NormalTok{,}
       \AttributeTok{pal=}\NormalTok{ pal,}
       \AttributeTok{lwd=}\FloatTok{0.3}\NormalTok{,}
       \AttributeTok{add=}\NormalTok{T)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 225 'NA' values are not plotted on the map.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{mf\_map}\NormalTok{(}\AttributeTok{x =}\NormalTok{ communes, }\AttributeTok{col =} \ConstantTok{NA}\NormalTok{, }\AttributeTok{border =} \StringTok{"gray25"}\NormalTok{, }\AttributeTok{lwd =} \DecValTok{1}\NormalTok{, }\AttributeTok{add=}\NormalTok{T)}
\end{Highlighting}
\end{Shaded}

\includegraphics{manuel_geo_quanti_files/figure-latex/unnamed-chunk-105-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#dev.off()}
\end{Highlighting}
\end{Shaded}

\hypertarget{un-tableau-de-statistique-pour-chaque-groupes}{%
\subsection{Un tableau de statistique pour chaque groupes}\label{un-tableau-de-statistique-pour-chaque-groupes}}

On réalise des statistiques (ici moyenne pondérée par le nombre de logements loués) par groupes:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{tab}\OtherTok{\textless{}{-}}\NormalTok{cadastre }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(clust) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}
    \AttributeTok{log\_sociaux=} \FunctionTok{weighted.mean}\NormalTok{(log\_sociaux,NB\_LOGLOUE\_TOT ),}
    \AttributeTok{entrep\_sprl\_sa=} \FunctionTok{weighted.mean}\NormalTok{(entrep\_sprl\_sa,NB\_LOGLOUE\_TOT ),}
    \AttributeTok{prop\_LOCDOM=} \FunctionTok{weighted.mean}\NormalTok{(prop\_LOCDOM,NB\_LOGLOUE\_TOT ),}
    \AttributeTok{prop\_LOC\_HBX  =} \FunctionTok{weighted.mean}\NormalTok{(prop\_LOC\_HBX,NB\_LOGLOUE\_TOT ),}
    \AttributeTok{dist\_200 =} \FunctionTok{weighted.mean}\NormalTok{(dist\_200,NB\_LOGLOUE\_TOT ),}
    \AttributeTok{cinq\_plus=} \FunctionTok{weighted.mean}\NormalTok{(cinq\_plus,NB\_LOGLOUE\_TOT ),}
    \AttributeTok{vingt\_plus=} \FunctionTok{weighted.mean}\NormalTok{(vingt\_plus,NB\_LOGLOUE\_TOT ) )}


\CommentTok{\# On ajoute une ligne pour la moyenne:}

\NormalTok{moyenne\_total}\OtherTok{\textless{}{-}}\NormalTok{cadastre }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}
    \AttributeTok{log\_sociaux=} \FunctionTok{weighted.mean}\NormalTok{(log\_sociaux,NB\_LOGLOUE\_TOT ),}
    \AttributeTok{entrep\_sprl\_sa=} \FunctionTok{weighted.mean}\NormalTok{(entrep\_sprl\_sa,NB\_LOGLOUE\_TOT ),}
    \AttributeTok{prop\_LOCDOM=} \FunctionTok{weighted.mean}\NormalTok{(prop\_LOCDOM,NB\_LOGLOUE\_TOT ),}
    \AttributeTok{prop\_LOC\_HBX  =} \FunctionTok{weighted.mean}\NormalTok{(prop\_LOC\_HBX,NB\_LOGLOUE\_TOT ),}
    \AttributeTok{dist\_200 =} \FunctionTok{weighted.mean}\NormalTok{(dist\_200,NB\_LOGLOUE\_TOT ),}
    \AttributeTok{cinq\_plus=} \FunctionTok{weighted.mean}\NormalTok{(cinq\_plus,NB\_LOGLOUE\_TOT ),}
    \AttributeTok{vingt\_plus=} \FunctionTok{weighted.mean}\NormalTok{(vingt\_plus,NB\_LOGLOUE\_TOT ) )}

\CommentTok{\# On place le résultat dans la ligne donc le numéro est équivalent au nombre de ligne dans le tableau plus une (nrow()+1) pour les colonnes de 2 à 8:}
\NormalTok{tab[}\FunctionTok{nrow}\NormalTok{(tab)}\SpecialCharTok{+}\DecValTok{1}\NormalTok{ ,  }\DecValTok{2}\SpecialCharTok{:}\DecValTok{8}\NormalTok{]}\OtherTok{\textless{}{-}}\NormalTok{moyenne\_total}

\CommentTok{\#On multiplie toutes les cellules par 100 et on arrondi avec un 1 chiffre après la virgule:}
\NormalTok{tab[,}\DecValTok{2}\SpecialCharTok{:}\DecValTok{8}\NormalTok{]}\OtherTok{\textless{}{-}}\FunctionTok{round}\NormalTok{(}\DecValTok{100}\SpecialCharTok{*}\NormalTok{tab[,}\DecValTok{2}\SpecialCharTok{:}\DecValTok{8}\NormalTok{],}\DecValTok{1}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

On peut alors donner des noms aux groupes

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{tab}\SpecialCharTok{$}\NormalTok{clust}\OtherTok{\textless{}{-}}\FunctionTok{as.character}\NormalTok{(tab}\SpecialCharTok{$}\NormalTok{clust)}
\NormalTok{tab}\OtherTok{\textless{}{-}}\NormalTok{ tab }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{clust=}\FunctionTok{case\_when}\NormalTok{ (}
\NormalTok{                   clust }\SpecialCharTok{==}\DecValTok{1}\SpecialCharTok{\textasciitilde{}}\StringTok{"1. Propriétaires à proximité"}\NormalTok{,}
\NormalTok{                   clust }\SpecialCharTok{==}\DecValTok{2}\SpecialCharTok{\textasciitilde{}}\StringTok{"2. Grands propriétaires et entreprises"}\NormalTok{,}
\NormalTok{                   clust }\SpecialCharTok{==}\DecValTok{3}\SpecialCharTok{\textasciitilde{}}\StringTok{"3. Type moyen"}\NormalTok{,}
\NormalTok{                   clust }\SpecialCharTok{==}\DecValTok{4}\SpecialCharTok{\textasciitilde{}}\StringTok{"4. Propriétaires non{-}Bruxellois"}\NormalTok{,}
\NormalTok{                   clust }\SpecialCharTok{==}\DecValTok{5}\SpecialCharTok{\textasciitilde{}}\StringTok{"5. Logements sociaux"}\NormalTok{,}
                   \FunctionTok{is.na}\NormalTok{(clust)}\SpecialCharTok{\textasciitilde{}}\StringTok{"Moyenne"}\NormalTok{))}

\FunctionTok{kable}\NormalTok{(tab)}
\end{Highlighting}
\end{Shaded}

\begin{tabular}{l|r|r|r|r|r|r|r}
\hline
clust & log\_sociaux & entrep\_sprl\_sa & prop\_LOCDOM & prop\_LOC\_HBX & dist\_200 & cinq\_plus & vingt\_plus\\
\hline
1. Propriétaires à proximité & 10.2 & 6.7 & 27.6 & 19.8 & 67.3 & 29.6 & 5.3\\
\hline
2. Grands propriétaires et entreprises & 3.4 & 26.0 & 5.8 & 26.4 & 26.4 & 47.3 & 20.1\\
\hline
3. Type moyen & 2.8 & 13.1 & 14.0 & 32.1 & 52.9 & 32.9 & 8.2\\
\hline
4. Propriétaires non-Bruxellois & 3.1 & 10.4 & 9.6 & 39.2 & 32.7 & 19.7 & 3.4\\
\hline
5. Logements sociaux & 78.0 & 1.9 & 2.4 & 7.1 & 7.8 & 13.7 & 3.3\\
\hline
Moyenne & 10.4 & 11.1 & 15.0 & 28.1 & 46.8 & 29.1 & 7.1\\
\hline
\end{tabular}

Le package JLutils permet également de colorer le dendogramme:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# library(JLutils)}
\FunctionTok{A2Rplot}\NormalTok{(hcpc, }\AttributeTok{k =}\DecValTok{5}\NormalTok{, }\AttributeTok{boxes =}\NormalTok{ T, }\AttributeTok{show.labels =}\NormalTok{ F,}\AttributeTok{col.up =} \StringTok{"gray50"}\NormalTok{,}
        \AttributeTok{col.down =}\NormalTok{ pal, }\AttributeTok{main=}\StringTok{"Dendrogramme {-} 5 classes"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{manuel_geo_quanti_files/figure-latex/unnamed-chunk-108-1.pdf}

\hypertarget{comparaison-avec-une-autre-variable}{%
\subsection{Comparaison avec une autre variable}\label{comparaison-avec-une-autre-variable}}

On importe l'indice synthétique de difficulté:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ind\_synth }\OtherTok{\textless{}{-}}\FunctionTok{read\_delim}\NormalTok{(}\StringTok{"data/indice\_synthetique.csv"}\NormalTok{, }\AttributeTok{delim=}\StringTok{";"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Rows: 7752 Columns: 2
## -- Column specification --------------------------------------------------------
## Delimiter: ";"
## chr (1): Secteur statistique
## dbl (1): Indice synthétique de difficulté 2010
## 
## i Use `spec()` to retrieve the full column specification for this data.
## i Specify the column types or set `show_col_types = FALSE` to quiet this message.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{indice\_sec}\OtherTok{\textless{}{-}}\NormalTok{secteurs\_stats }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{left\_join}\NormalTok{(ind\_synth, }\AttributeTok{by=}\FunctionTok{c}\NormalTok{(}\StringTok{"cd\_sector"}\OtherTok{=}\StringTok{"Secteur statistique"}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{filter}\NormalTok{(tx\_rgn\_descr\_fr}\SpecialCharTok{==}\StringTok{"Région de Bruxelles{-}Capitale"}\NormalTok{)}

\FunctionTok{mf\_map}\NormalTok{(indice\_sec, }
       \AttributeTok{var=}\StringTok{"Indice synthétique de difficulté 2010"}\NormalTok{, }
       \AttributeTok{type=}\StringTok{"choro"}\NormalTok{, }
       \AttributeTok{pal=} \StringTok{"Viridis"}\NormalTok{, }
       \AttributeTok{nbreaks=}\DecValTok{5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{manuel_geo_quanti_files/figure-latex/unnamed-chunk-110-1.pdf}

On joint l'indice synthétique de difficulté avec les données sur base du secteur statistique:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{cadastre}\OtherTok{\textless{}{-}}\NormalTok{ cadastre }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{left\_join}\NormalTok{(ind\_synth,}\AttributeTok{by=} \FunctionTok{c}\NormalTok{(}\StringTok{"cd\_sector"}\OtherTok{=} \StringTok{"Secteur statistique"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

On réalise un graphique avec des boxplot:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(}\AttributeTok{data=}\NormalTok{cadastre,}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\NormalTok{clust,}
                           \AttributeTok{y=}\StringTok{\textasciigrave{}}\AttributeTok{Indice synthétique de difficulté 2010}\StringTok{\textasciigrave{}}\NormalTok{,}
                           \AttributeTok{weight=}\NormalTok{NB\_LOGLOUE\_TOT,}
                           \AttributeTok{fill=}\NormalTok{clust)) }\SpecialCharTok{+}
\FunctionTok{geom\_boxplot}\NormalTok{(}\AttributeTok{fill=}\NormalTok{pal) }\SpecialCharTok{+}
\FunctionTok{labs}\NormalTok{(}\AttributeTok{title =}\StringTok{"Relation classification et indice synthétique de difficulté"}\NormalTok{,}
       \AttributeTok{x=} \StringTok{" "}\NormalTok{,}
       \AttributeTok{y=} \StringTok{"Indice synth. de diff. 2010"}\NormalTok{)}\SpecialCharTok{+}
\FunctionTok{theme\_minimal}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics{manuel_geo_quanti_files/figure-latex/unnamed-chunk-112-1.pdf}

On peut en conclure qu'il y a un lien entre la division sociale de l'espace et la structure de la propriété des logements loués. Les secteurs du groupe 1 sont plus en difficulté que les autres secteurs, surtout les 3 et 4. Le secteurs centraux (2) ont des indices intermédiaires et certains secteurs de logements sociaux (5) sont très mixtes d'où leur forte dispersion.

\hypertarget{ressources-utilisuxe9es-1}{%
\section{Ressources utilisées}\label{ressources-utilisuxe9es-1}}

\begin{itemize}
\item
  \url{https://larmarange.github.io/analyse-R/classification-ascendante-hierarchique.html}
\item
  \url{http://factominer.free.fr/factomethods/classification-hierarchique-sur-composantes-principales.html}
\item
  \url{http://www.sthda.com/english/articles/31-principal-component-methods-in-r-practical-guide/117-hcpc-hierarchical-clustering-on-principal-components-essentials/}
\end{itemize}

  \bibliography{book.bib,packages.bib}

\end{document}
